<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
    <title>Micronaut projectgen</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="stylesheet" href="../css/main.css" type="text/css" media="screen, print" title="Style" charset="utf-8" />
    <link rel="stylesheet" href="../css/custom.css" type="text/css" media="screen, print" title="Style" charset="utf-8" />
    <link rel="stylesheet" href="../css/pdf.css" type="text/css" media="print" title="PDF" charset="utf-8" />
    <link rel="stylesheet" href="../css/highlight/agate.css">
    <script src="../js/highlight.pack.js"></script>
    <script src="../js/guide.js"></script>
    <script src="../js/multi-language-sample.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <link rel="stylesheet" href="../css/multi-language-sample.css"/>
    <script src="../js/docs.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.5.13/clipboard.min.js"></script>
    <script type="text/javascript">
        function addJsClass(el) {
            var classes = document.body.className.split(" ");
            classes.push("js");
            document.body.className = classes.join(" ");
        }
    </script>

</head>

<body class="body" id="docs" onload="addJsClass();" onhashchange="highlightMenu()">

<div id="table-of-content-nav-link" class="desktop">
    <a id="theme-switcher" title="Switch to dark theme" href="javascript:switchTheme(true)"><i class="fa fa-moon-o"></i></a>
    <a title="Collapse/Open Table of contents" title="Hide Table of Contents" href="javascript:hideTableOfContents();" class="button">[ + ]</a>
</div>

<div id="main">
    <div id="navigation" class="no-print">
        <div class="navTitle">
            <span id="logo"><a href="http://micronaut.io" title="Go to Micronaut Website"><img src="../img/micronaut-logo-white.svg" alt="Micronaut"/></a></span>
        </div>
        <div class="navLinks">
            <ul>
                    <li><div id="nav-summary" onmouseover="toggleNavSummary(false)" onmouseout="toggleNavSummary(true)" class="desktop">
                            <a href="../guide/index.html" class="button">Table of contents</a>
                            <div id="nav-summary-childs" style="display:none;">
                                
                                <div class="toc-item" style="margin-left:0"><a href="#introduction"><strong>1</strong><span>Introduction</span></a></div>
                                
                                <div class="toc-item" style="margin-left:0"><a href="#releaseHistory"><strong>2</strong><span>Release History</span></a></div>
                                
                                <div class="toc-item" style="margin-left:0"><a href="#modules"><strong>3</strong><span>Modules</span></a></div>
                                
                                <div class="toc-item" style="margin-left:0"><a href="#features"><strong>4</strong><span>Features</span></a></div>
                                
                                <div class="toc-item" style="margin-left:0"><a href="#demo"><strong>5</strong><span>Demo</span></a></div>
                                
                                <div class="toc-item" style="margin-left:0"><a href="#repository"><strong>6</strong><span>Repository</span></a></div>
                                
                            </div>
                        </div>
                    </li>

                <li id="table-of-content-nav-link-mobile" class="mobile">
                    <a title="Scroll to Table of contents" href="javascript:scrollToTop();" class="button">Toc</a>
                </li>
                <li class="desktop">
                    <a title="Go to API documentation" href="../api/index.html" class="button">API Reference</a>
                </li>
                <li class="mobile">
                    <a title="Go to API documentation" href="../api/index.html" class="button">API</a>
                </li>
                <li class="desktop">
                    <a title="Go to Configuration Reference documentation" href="../guide/configurationreference.html" class="button">Configuration Reference</a>
                </li>
                <li class="mobile">
                    <a title="Go to Configuration Reference documentation" href="../guide/configurationreference.html" class="button">Conf</a>
                </li>
            </ul>

        </div>
    </div>
    
    <div id="table-of-content">
        <div class="toc-content">

        <h2>Table of Contents</h2>
        
        <div class="toc-item" style="margin-left:0px" id="toc-item-introduction"><a href="#introduction"><strong>1</strong><span>Introduction</span></a></div>
        
        <div class="toc-item" style="margin-left:0px" id="toc-item-releaseHistory"><a href="#releaseHistory"><strong>2</strong><span>Release History</span></a></div>
        
        <div class="toc-item" style="margin-left:0px" id="toc-item-modules"><a href="#modules"><strong>3</strong><span>Modules</span></a></div>
        
        <div class="toc-item" style="margin-left:10px" id="toc-item-coreModule"><a href="#coreModule"><strong>3.1</strong><span>Core Module</span></a></div>
        
        <div class="toc-item" style="margin-left:10px" id="toc-item-testModule"><a href="#testModule"><strong>3.2</strong><span>Test Module</span></a></div>
        
        <div class="toc-item" style="margin-left:10px" id="toc-item-httpServer"><a href="#httpServer"><strong>3.3</strong><span>HTTP Server Module</span></a></div>
        
        <div class="toc-item" style="margin-left:20px" id="toc-item-downloadZip"><a href="#downloadZip"><strong>3.3.1</strong><span>Download ZIP</span></a></div>
        
        <div class="toc-item" style="margin-left:20px" id="toc-item-featuresHttpServer"><a href="#featuresHttpServer"><strong>3.3.2</strong><span>Features</span></a></div>
        
        <div class="toc-item" style="margin-left:20px" id="toc-item-diff"><a href="#diff"><strong>3.3.3</strong><span>Diff</span></a></div>
        
        <div class="toc-item" style="margin-left:0px" id="toc-item-features"><a href="#features"><strong>4</strong><span>Features</span></a></div>
        
        <div class="toc-item" style="margin-left:0px" id="toc-item-demo"><a href="#demo"><strong>5</strong><span>Demo</span></a></div>
        
        <div class="toc-item" style="margin-left:10px" id="toc-item-defineOptions"><a href="#defineOptions"><strong>5.1</strong><span>Options</span></a></div>
        
        <div class="toc-item" style="margin-left:10px" id="toc-item-addDependency"><a href="#addDependency"><strong>5.2</strong><span>Add Dependency</span></a></div>
        
        <div class="toc-item" style="margin-left:10px" id="toc-item-addBuildProperties"><a href="#addBuildProperties"><strong>5.3</strong><span>Add Build Properties</span></a></div>
        
        <div class="toc-item" style="margin-left:10px" id="toc-item-addGradlePlugins"><a href="#addGradlePlugins"><strong>5.4</strong><span>Add Gradle Plugins</span></a></div>
        
        <div class="toc-item" style="margin-left:10px" id="toc-item-addMavenPlugin"><a href="#addMavenPlugin"><strong>5.5</strong><span>Add Maven Plugins</span></a></div>
        
        <div class="toc-item" style="margin-left:10px" id="toc-item-addCode"><a href="#addCode"><strong>5.6</strong><span>Add Code</span></a></div>
        
        <div class="toc-item" style="margin-left:10px" id="toc-item-root"><a href="#root"><strong>5.7</strong><span>Default Feature</span></a></div>
        
        <div class="toc-item" style="margin-left:10px" id="toc-item-cli"><a href="#cli"><strong>5.8</strong><span>Project Generation in a Command Line Application</span></a></div>
        
        <div class="toc-item" style="margin-left:10px" id="toc-item-httpServerDemo"><a href="#httpServerDemo"><strong>5.9</strong><span>Project Generation in a HTTP Server</span></a></div>
        
        <div class="toc-item" style="margin-left:10px" id="toc-item-test"><a href="#test"><strong>5.10</strong><span>Test Project Generation</span></a></div>
        
        <div class="toc-item" style="margin-left:0px" id="toc-item-repository"><a href="#repository"><strong>6</strong><span>Repository</span></a></div>
        
        </div>
    </div>
    
    <div class="docs-content">
    <div class="project">
        <h1>Micronaut projectgen</h1>
        <p></p>
        <p>API to generate JVM projects</p>
        <p><strong>Version:</strong> 0.0.6 </p>
    </div>
    
<h1 id="introduction"><a class="anchor" href="#introduction"></a>1 Introduction</h1>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-projectgen/edit/0.0.x/src/main/docs/guide/introduction.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>Micronaut ProjectGen offers an API to generate JVM projects.</p>
</div>

<h1 id="releaseHistory"><a class="anchor" href="#releaseHistory"></a>2 Release History</h1>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-projectgen/edit/0.0.x/src/main/docs/guide/releaseHistory.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>For this project, you can find a list of releases (with release notes) here:</p>
</div>
<div class="paragraph">
<p><a href="https://github.com/micronaut-projects/micronaut-projectgen/releases">https://github.com/micronaut-projects/micronaut-projectgen/releases</a></p>
</div>

<h1 id="modules"><a class="anchor" href="#modules"></a>3 Modules</h1>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-projectgen/edit/0.0.x/src/main/docs/guide/modules.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>




<h2 id="coreModule"><a class="anchor" href="#coreModule"></a>3.1 Core Module</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-projectgen/edit/0.0.x/src/main/docs/guide/modules/coreModule.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>The following dependency contains the core APIs to generate applications.</p>
</div>
<div class="paragraph">
<p>        <div class="listingblock multi-language-sample">
<div class="title"></div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="gradle">implementation(<span class="hljs-string">"io.micronaut.projectgen:micronaut-projectgen-core")</span></code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="maven">&lt;dependency&gt;
    &lt;groupId&gt;io.micronaut.projectgen&lt;/groupId&gt;
    &lt;artifactId&gt;micronaut-projectgen-core&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div></p>
</div>

<h2 id="testModule"><a class="anchor" href="#testModule"></a>3.2 Test Module</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-projectgen/edit/0.0.x/src/main/docs/guide/modules/testModule.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>The following dependency contains utilities to test the generated application.</p>
</div>
<div class="paragraph">
<p>        <div class="listingblock multi-language-sample">
<div class="title"></div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="gradle">testImplementation(<span class="hljs-string">"io.micronaut.projectgen:micronaut-projectgen-test")</span></code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="maven">&lt;dependency&gt;
    &lt;groupId&gt;io.micronaut.projectgen&lt;/groupId&gt;
    &lt;artifactId&gt;micronaut-projectgen-test&lt;/artifactId&gt;
    &lt;scope&gt;test&lt;/scope&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div></p>
</div>

<h2 id="httpServer"><a class="anchor" href="#httpServer"></a>3.3 HTTP Server Module</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-projectgen/edit/0.0.x/src/main/docs/guide/modules/httpServer.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>If you want to expose your project generator in an HTTP Server, add the following dependency:</p>
</div>
<div class="paragraph">
<p>        <div class="listingblock multi-language-sample">
<div class="title"></div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="gradle">implementation(<span class="hljs-string">"io.micronaut.projectgen:micronaut-projectgen-http-server")</span></code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="maven">&lt;dependency&gt;
    &lt;groupId&gt;io.micronaut.projectgen&lt;/groupId&gt;
    &lt;artifactId&gt;micronaut-projectgen-http-server&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div></p>
</div>

<h2 id="downloadZip"><a class="anchor" href="#downloadZip"></a>3.3.1 Download ZIP</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-projectgen/edit/0.0.x/src/main/docs/guide/modules/httpServer/downloadZip.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>A POST endpoint with a <code>application/x-www-form-urlencoded</code> content type allows you to download a ZIP file:</p>
</div>
<a id="io.micronaut.projectgen.http.server.conf.DownloadZipControllerConfiguration" href="#io.micronaut.projectgen.http.server.conf.DownloadZipControllerConfiguration">&#128279;</a>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 1. Configuration Properties for <a href="../api/io/micronaut/projectgen/http/server/conf/DownloadZipControllerConfiguration.html">DownloadZipControllerConfiguration</a></caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Property</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>projectgen.controllers.download-zip.enabled</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Whether the controller is enabled. Default value: true.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>projectgen.controllers.download-zip.path</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">java.lang.String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Controller path. Default value: /api/v1/download/zip</p></td>
</tr>
</tbody>
</table>

<h2 id="featuresHttpServer"><a class="anchor" href="#featuresHttpServer"></a>3.3.2 Features</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-projectgen/edit/0.0.x/src/main/docs/guide/modules/httpServer/featuresHttpServer.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>A POST endpoint with a <code>application/x-www-form-urlencoded</code> content type allows you to get a JSON payload with the visible features.</p>
</div>
<a id="io.micronaut.projectgen.http.server.conf.FeaturesControllerConfiguration" href="#io.micronaut.projectgen.http.server.conf.FeaturesControllerConfiguration">&#128279;</a>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 1. Configuration Properties for <a href="../api/io/micronaut/projectgen/http/server/conf/FeaturesControllerConfiguration.html">FeaturesControllerConfiguration</a></caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Property</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>projectgen.controllers.features.enabled</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Whether the controller is enabled. Default value: true.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>projectgen.controllers.features.path</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">java.lang.String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Controller path. Default value: /api/v1/features</p></td>
</tr>
</tbody>
</table>

<h2 id="diff"><a class="anchor" href="#diff"></a>3.3.3 Diff</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-projectgen/edit/0.0.x/src/main/docs/guide/modules/httpServer/diff.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>Adding the following dependency, a bean of type <a href="../api/io/micronaut/projectgen/core/diff/FeatureDiffer.html">FeatureDiffer</a> is registered:</p>
</div>
<div class="paragraph">
<p>        <div class="listingblock multi-language-sample">
<div class="title"></div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="gradle">implementation(<span class="hljs-string">"io.github.java-diff-utils:java-diff-utils:4.15")</span></code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="maven">&lt;dependency&gt;
    &lt;groupId&gt;io.github.java-diff-utils&lt;/groupId&gt;
    &lt;artifactId&gt;java-diff-utils&lt;/artifactId&gt;
    &lt;version&gt;4.15&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div></p>
</div>
<div class="paragraph">
<p>Once you have a bean of type <a href="../api/io/micronaut/projectgen/core/diff/FeatureDiffer.html">FeatureDiffer</a> and
the <code>io.micronaut.projectgen:micronaut-projectgen-http-server</code> dependency the following endpoints which accept aPOST endpoints
with a <code>application/x-www-form-urlencoded</code> content type.</p>
</div>
<a id="io.micronaut.projectgen.http.server.conf.DiffControllerConfiguration" href="#io.micronaut.projectgen.http.server.conf.DiffControllerConfiguration">&#128279;</a>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 1. Configuration Properties for <a href="../api/io/micronaut/projectgen/http/server/conf/DiffControllerConfiguration.html">DiffControllerConfiguration</a></caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Property</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>project.controllers.diff.enabled</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Whether the controller is enabled. Default value: true.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>project.controllers.diff.path</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">java.lang.String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Controller path. Default value: /api/v1/diff</p></td>
</tr>
</tbody>
</table>
<a id="io.micronaut.projectgen.http.server.conf.DownloadDiffControllerConfiguration" href="#io.micronaut.projectgen.http.server.conf.DownloadDiffControllerConfiguration">&#128279;</a>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 2. Configuration Properties for <a href="../api/io/micronaut/projectgen/http/server/conf/DownloadDiffControllerConfiguration.html">DownloadDiffControllerConfiguration</a></caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Property</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>projectgen.controllers.download-diff.enabled</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Whether the controller is enabled. Default value: true.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>projectgen.controllers.download-diff.path</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">java.lang.String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Controller path. Default value: /api/v1/download/diff</p></td>
</tr>
</tbody>
</table>

<h1 id="features"><a class="anchor" href="#features"></a>4 Features</h1>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-projectgen/edit/0.0.x/src/main/docs/guide/features.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>To generate a project, you create beans of type <a href="../api/io/micronaut/projectgen/core/feature/Feature.html">Feature</a>.</p>
</div>
<div class="paragraph">
<p>Each feature has a unique identifier; you can offer a <a href="https://launch.micronaut.io">UI</a> to allow users to select a feature.</p>
</div>

<h1 id="demo"><a class="anchor" href="#demo"></a>5 Demo</h1>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-projectgen/edit/0.0.x/src/main/docs/guide/demo.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>To talk about the ProjectGen API, let&#8217;s discuss the following demo: a Hello World application with Maven and Gradle.</p>
</div>
<div class="paragraph">
<p>The project structure will be like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">├── build.gradle.kts
├── gradle
│   └── wrapper
│       ├── gradle-wrapper.jar
│       └── gradle-wrapper.properties
├── gradle.properties
├── gradlew
├── gradlew.bat
├── mvnw
├── mvnw.bat
├── pom.xml
├── settings.gradle.kts
└── src
    ├── main
    │   └── java
    │       └── com
    │           └── example
    │               └── HelloWorld.java
    └── test
        └── java
            └── com
                └── example
                    └── HelloWorldTest.java</code></pre>
</div>
</div>
<div class="paragraph">
<p>You want to generate a <code>build.gradle.kts</code> with the following content:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">plugins {
    id("java")
    id("application")
}
group = "io.micronaut.projectgen"
version = "1.0.0"
repositories {
    mavenCentral()
}
dependencies {
    testImplementation("org.junit.jupiter:junit-jupiter:5.10.2")
}
java {
    sourceCompatibility = JavaVersion.VERSION_21
    targetCompatibility = JavaVersion.VERSION_21
}
tasks.test {
    useJUnitPlatform()
}

application {
    mainClass.set("com.example.HelloWorld")
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>and a <code>pom.xml</code> with the following content:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"&gt;
  &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;
  &lt;groupId&gt;io.micronaut.projectgen&lt;/groupId&gt;
  &lt;artifactId&gt;demo-project&lt;/artifactId&gt;
  &lt;version&gt;1.0.0&lt;/version&gt;
  &lt;properties&gt;
    &lt;maven.compiler.source&gt;21&lt;/maven.compiler.source&gt;
    &lt;maven.compiler.target&gt;21&lt;/maven.compiler.target&gt;
  &lt;/properties&gt;
  &lt;dependencies&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;org.junit.jupiter&lt;/groupId&gt;
      &lt;artifactId&gt;junit-jupiter&lt;/artifactId&gt;
      &lt;version&gt;5.10.2&lt;/version&gt;
      &lt;scope&gt;test&lt;/scope&gt;
    &lt;/dependency&gt;
  &lt;/dependencies&gt;
  &lt;build&gt;
    &lt;plugins&gt;
      &lt;plugin&gt;
        &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
        &lt;artifactId&gt;maven-surefire-plugin&lt;/artifactId&gt;
        &lt;version&gt;3.1.2&lt;/version&gt;
      &lt;/plugin&gt;
      &lt;plugin&gt;
          &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
          &lt;artifactId&gt;maven-jar-plugin&lt;/artifactId&gt;
          &lt;version&gt;3.3.0&lt;/version&gt;
          &lt;configuration&gt;
              &lt;archive&gt;
                  &lt;manifest&gt;
                      &lt;mainClass&gt;com.example.HelloWorld&lt;/mainClass&gt;
                  &lt;/manifest&gt;
              &lt;/archive&gt;
          &lt;/configuration&gt;
      &lt;/plugin&gt;
    &lt;/plugins&gt;
  &lt;/build&gt;
&lt;/project&gt;</code></pre>
</div>
</div>

<h2 id="defineOptions"><a class="anchor" href="#defineOptions"></a>5.1 Options</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-projectgen/edit/0.0.x/src/main/docs/guide/demo/defineOptions.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>To generate a project, you need an implementation of the interface <a href="../api/io/micronaut/projectgen/core/options/Options.html">Options</a>.</p>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package io.micronaut.projectgen.demo;

import io.micronaut.projectgen.core.buildtools.BuildTool;
import io.micronaut.projectgen.core.buildtools.gradle.GradleDsl;
import io.micronaut.projectgen.core.options.GenericOptionsBuilder;
import io.micronaut.projectgen.core.options.JdkVersion;
import io.micronaut.projectgen.core.options.Options;

import java.util.List;

public final class OptionsFactory {
    private OptionsFactory() {
    }

    public static Options create(List&lt;String&gt; features) {
        return GenericOptionsBuilder.builder()
                .name("demo")
                .packageName("com.example")
                .group("io.micronaut.projectgen")
                .artifact("demo-project")
                .version("1.0.0")
                .features(features)
                .buildTools(List.of(BuildTool.MAVEN, BuildTool.GRADLE))
                .gradleDsl(GradleDsl.KOTLIN)
                .java(JdkVersion.JDK_21)
                .build();
    }
}</code></pre>
</div>
</div>

<h2 id="addDependency"><a class="anchor" href="#addDependency"></a>5.2 Add Dependency</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-projectgen/edit/0.0.x/src/main/docs/guide/demo/addDependency.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>The following feature adds a dependency:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package io.micronaut.projectgen.demo;

import io.micronaut.projectgen.core.buildtools.MavenCentral;
import io.micronaut.projectgen.core.buildtools.dependencies.Dependency;
import io.micronaut.projectgen.core.feature.Feature;
import io.micronaut.projectgen.core.generator.GeneratorContext;
import io.micronaut.projectgen.core.generator.ModuleContext;
import io.micronaut.projectgen.core.utils.OptionUtils;
import jakarta.inject.Singleton;

@Singleton
class JunitJupiter implements Feature {
    private static final Dependency DEPENDENCY_JUNIT_JUPITER = Dependency.builder() <i class="conum" data-value="1"></i><b>(1)</b>
        .groupId("org.junit.jupiter")
        .artifactId("junit-jupiter")
        .version("5.10.2")
        .test()
        .build();

    @Override
    public boolean isVisible() {
        return false;
    }

    @Override
    public String getName() {
        return "junit-jupiter";
    }

    @Override
    public String getDescription() {
        return "Adds the JUnit Jupiter dependency to the project";
    }

    @Override
    public void apply(GeneratorContext generatorContext) {
        ModuleContext module = generatorContext.getRootModule();
        if (OptionUtils.hasGradleBuildTool(generatorContext.getOptions())) {
            module.repositories().add(new MavenCentral()); <i class="conum" data-value="1"></i><b>(1)</b>
        }
        module.addDependency(DEPENDENCY_JUNIT_JUPITER); <i class="conum" data-value="2"></i><b>(2)</b>
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>A feature can add repository.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>You can use fluid <a href="../api/io/micronaut/projectgen/core/buildtools/dependencies/Dependency.html">Dependency</a> API to add dependencies to your project.</td>
</tr>
</table>
</div>

<h2 id="addBuildProperties"><a class="anchor" href="#addBuildProperties"></a>5.3 Add Build Properties</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-projectgen/edit/0.0.x/src/main/docs/guide/demo/addBuildProperties.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>The following feature adds build properties:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package io.micronaut.projectgen.demo;

import io.micronaut.projectgen.core.buildtools.BuildProperties;
import io.micronaut.projectgen.core.feature.Feature;
import io.micronaut.projectgen.core.generator.GeneratorContext;
import io.micronaut.projectgen.core.options.Options;
import io.micronaut.projectgen.core.utils.OptionUtils;
import jakarta.inject.Singleton;

@Singleton
class MavenCompilerProperties implements Feature {
    @Override
    public String getName() {
        return "maven-compiler-properties";
    }

    @Override
    public boolean isVisible() {
        return false;
    }

    @Override
    public void apply(GeneratorContext generatorContext) {
        Options options = generatorContext.getOptions();
        if (OptionUtils.hasMavenBuildTool(options)) {
            BuildProperties buildProperties = generatorContext.getRootModule()
                .buildProperties();
            String java = String.valueOf(options
                .java()
                .majorVersion());
            buildProperties.put("maven.compiler.source", java);
            buildProperties.put("maven.compiler.target", java);
        }
    }
}</code></pre>
</div>
</div>

<h2 id="addGradlePlugins"><a class="anchor" href="#addGradlePlugins"></a>5.4 Add Gradle Plugins</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-projectgen/edit/0.0.x/src/main/docs/guide/demo/addGradlePlugins.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>You can use ProjectGen <a href="../api/io/micronaut/projectgen/core/buildtools/gradle/GradlePlugin.html">GradlePlugin</a> API to add Gradle Plugins to a project.</p>
</div>
<div class="paragraph">
<p>The following feature adds the <a href="https://docs.gradle.org/current/userguide/java_plugin.html">Gradle Java Plugin</a>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package io.micronaut.projectgen.demo;

import io.micronaut.projectgen.core.buildtools.gradle.GradlePlugin;
import io.micronaut.projectgen.core.feature.Feature;
import io.micronaut.projectgen.core.generator.GeneratorContext;
import io.micronaut.projectgen.core.utils.OptionUtils;
import jakarta.inject.Singleton;

@Singleton
class GradleJavaPluginFeature implements Feature {
    @Override
    public String getName() {
        return "gradle-plugin-java";
    }

    @Override
    public boolean isVisible() {
        return false;
    }

    @Override
    public void apply(GeneratorContext generatorContext) {
        if (OptionUtils.hasGradleBuildTool(generatorContext.getOptions())) {
            int javaVersion = generatorContext.getOptions()
                .java()
                .majorVersion();
            generatorContext.getRootModule()
                .addBuildPlugin(GradlePlugin.builder()
                    .id("java")
                    .extension(String.format("""
                        java {
                            sourceCompatibility = JavaVersion.VERSION_%1$d
                            targetCompatibility = JavaVersion.VERSION_%1$d
                        }
                        tasks.test {
                            useJUnitPlatform()
                        }""", javaVersion))
                .build());
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following feature adds <a href="https://docs.gradle.org/current/userguide/application_plugin.html">Gradle Application Plugin</a>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package io.micronaut.projectgen.demo;

import io.micronaut.projectgen.core.buildtools.gradle.GradlePlugin;
import io.micronaut.projectgen.core.feature.Feature;
import io.micronaut.projectgen.core.generator.GeneratorContext;
import io.micronaut.projectgen.core.utils.OptionUtils;
import jakarta.inject.Singleton;

@Singleton
class GradleApplicationPluginFeature implements Feature {
    @Override
    public String getName() {
        return "gradle-plugin-application";
    }

    @Override
    public boolean isVisible() {
        return false;
    }

    @Override
    public void apply(GeneratorContext generatorContext) {
        if (OptionUtils.hasGradleBuildTool(generatorContext.getOptions())) {
            generatorContext.getRootModule()
                .addBuildPlugin(GradlePlugin.builder()
                    .id("application")
                    .extension("""
                application {
                    mainClass.set("%s.HelloWorld")
                }""".formatted(generatorContext.getOptions().packageName()))
                    .build());
        }

    }
}</code></pre>
</div>
</div>

<h2 id="addMavenPlugin"><a class="anchor" href="#addMavenPlugin"></a>5.5 Add Maven Plugins</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-projectgen/edit/0.0.x/src/main/docs/guide/demo/addMavenPlugin.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>You can use ProjectGen <a href="../api/io/micronaut/projectgen/core/buildtools/maven/MavenPlugin.html">MavenPlugin</a> API to add Maven Plugins to a project.</p>
</div>
<div class="paragraph">
<p>The following feature adds the <a href="https://maven.apache.org/plugins/maven-jar-plugin/">Maven Jar Plugin</a>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package io.micronaut.projectgen.demo;

import io.micronaut.projectgen.core.buildtools.maven.MavenPlugin;
import io.micronaut.projectgen.core.feature.Feature;
import io.micronaut.projectgen.core.generator.GeneratorContext;
import jakarta.inject.Singleton;

@Singleton
class MavenJarPluginFeature implements Feature {
    @Override
    public String getName() {
        return "maven-jar-plugin";
    }

    @Override
    public boolean isVisible() {
        return false;
    }

    @Override
    public void apply(GeneratorContext generatorContext) {
        generatorContext.getRootModule().addBuildPlugin(MavenPlugin.builder()
            .groupId("org.apache.maven.plugins")
            .artifactId("maven-jar-plugin")
            .extension(String.format("""
            &lt;plugin&gt;
                &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
                &lt;artifactId&gt;maven-jar-plugin&lt;/artifactId&gt;
                &lt;version&gt;3.3.0&lt;/version&gt;
                &lt;configuration&gt;
                    &lt;archive&gt;
                        &lt;manifest&gt;
                            &lt;mainClass&gt;%s.HelloWorld&lt;/mainClass&gt;
                        &lt;/manifest&gt;
                    &lt;/archive&gt;
                &lt;/configuration&gt;
            &lt;/plugin&gt;""", generatorContext.getOptions().packageName()))
            .build());
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following feature adds <a href="https://maven.apache.org/surefire/maven-surefire-plugin/">Maven Surefire Plugin</a>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package io.micronaut.projectgen.demo;

import io.micronaut.core.annotation.NonNull;
import io.micronaut.projectgen.core.buildtools.maven.MavenPlugin;
import io.micronaut.projectgen.core.feature.Feature;
import io.micronaut.projectgen.core.generator.GeneratorContext;
import io.micronaut.projectgen.core.utils.OptionUtils;
import jakarta.inject.Singleton;

@Singleton
class MavenSurefirePlugin implements Feature {
    private static final @NonNull MavenPlugin MAVEN_PLUGIN_SUREFIRE = MavenPlugin.builder() <i class="conum" data-value="1"></i><b>(1)</b>
        .groupId("org.apache.maven.plugins")
        .artifactId("maven-surefire-plugin")
        .version("3.1.2")
        .build();

    @Override
    public boolean isVisible() {
        return false;
    }

    @Override
    public String getName() {
        return "maven-surefire-plugin";
    }

    @Override
    public void apply(GeneratorContext generatorContext) {
        if (OptionUtils.hasMavenBuildTool(generatorContext.getOptions())) {
            generatorContext.getRootModule().addBuildPlugin(MAVEN_PLUGIN_SUREFIRE);
        }
    }
}</code></pre>
</div>
</div>

<h2 id="addCode"><a class="anchor" href="#addCode"></a>5.6 Add Code</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-projectgen/edit/0.0.x/src/main/docs/guide/demo/addCode.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>The following feature adds source code:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package io.micronaut.projectgen.demo;

import io.micronaut.projectgen.core.feature.Feature;
import io.micronaut.projectgen.core.generator.GeneratorContext;
import io.micronaut.projectgen.core.generator.ModuleContext;
import io.micronaut.projectgen.core.template.StringTemplate;
import jakarta.inject.Singleton;

@Singleton
class SampleCode implements Feature {
    @Override
    public String getName() {
        return "sample-code";
    }

    @Override
    public void apply(GeneratorContext generatorContext) {
        ModuleContext module = generatorContext.getRootModule();
        addHelloWorldJavaClass(module);
    }

    @Override
    public boolean isVisible() {
        return false;
    }

    private void addHelloWorldJavaClass(ModuleContext module) {
        String path = "src/main/java/com/example/HelloWorld.java";
        module.addTemplate("HelloWorld.java", new io.micronaut.projectgen.core.template.StringTemplate(path, """
            package com.example;

            public class HelloWorld {
                public static void main(String[] args) {
                    System.out.println(hello());
                }

                public static String hello() {
                    return "Hello, World!";
                }
            }
            """));
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can add files to the generated project. The previous example shows a String, but you can use the <a href="../api/io/micronaut/projectgen/core/rocker/RockerWritable.html">RockerWritable</a> API to render files with <a href="https://github.com/fizzed/rocker">Rocker Templates</a>.</p>
</div>

<h2 id="root"><a class="anchor" href="#root"></a>5.7 Default Feature</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-projectgen/edit/0.0.x/src/main/docs/guide/demo/root.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>You can create beans of type <a href="../api/io/micronaut/projectgen/core/feature/DefaultFeature.html">DefaultFeature</a> to be
automatically applied if the method <code>DefaultFeature::shouldApply</code> evaluates to true.</p>
</div>
<div class="paragraph">
<p>A common pattern is to define a <code>DefaultFeature</code> to act as the entry point of the project generation.</p>
</div>
<div class="paragraph">
<p>A feature can apply other features as shown below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package io.micronaut.projectgen.demo;

import io.micronaut.core.annotation.NonNull;
import io.micronaut.projectgen.core.buildtools.BuildProperties;
import io.micronaut.projectgen.core.buildtools.MavenCentral;
import io.micronaut.projectgen.core.buildtools.dependencies.Dependency;
import io.micronaut.projectgen.core.buildtools.gradle.GradlePlugin;
import io.micronaut.projectgen.core.buildtools.maven.MavenPlugin;
import io.micronaut.projectgen.core.feature.DefaultFeature;
import io.micronaut.projectgen.core.feature.Feature;
import io.micronaut.projectgen.core.feature.FeatureContext;
import io.micronaut.projectgen.core.generator.GeneratorContext;
import io.micronaut.projectgen.core.generator.ModuleContext;
import io.micronaut.projectgen.core.options.Options;
import io.micronaut.projectgen.core.utils.OptionUtils;
import jakarta.inject.Singleton;
import io.micronaut.projectgen.core.template.StringTemplate;
import java.util.Set;

@Singleton
class Root implements DefaultFeature {

    private final GradleJavaPluginFeature gradleJavaPluginFeature;
    private final GradleApplicationPluginFeature gradleApplicationPluginFeature;
    private final MavenSurefirePlugin mavenSurefirePlugin;
    private final MavenJarPluginFeature mavenJarPluginFeature;
    private final SampleCode sampleCode;
    private final MavenCompilerProperties mavenCompilerProperties;

    Root(GradleJavaPluginFeature gradleJavaPluginFeature,
         GradleApplicationPluginFeature gradleApplicationPluginFeature,
         MavenSurefirePlugin mavenSurefirePlugin,
         MavenJarPluginFeature mavenJarPluginFeature,
         SampleCode sampleCode, MavenCompilerProperties mavenCompilerProperties) {
        this.gradleJavaPluginFeature = gradleJavaPluginFeature;
        this.gradleApplicationPluginFeature = gradleApplicationPluginFeature;
        this.mavenSurefirePlugin = mavenSurefirePlugin;
        this.mavenJarPluginFeature = mavenJarPluginFeature;
        this.sampleCode = sampleCode;
        this.mavenCompilerProperties = mavenCompilerProperties;
    }

    @Override
    public void processSelectedFeatures(FeatureContext featureContext) {
        featureContext.addFeature(gradleJavaPluginFeature);
        featureContext.addFeature(gradleApplicationPluginFeature);
        featureContext.addFeature(mavenSurefirePlugin);
        featureContext.addFeature(mavenJarPluginFeature);
        featureContext.addFeature(sampleCode);
        featureContext.addFeature(mavenCompilerProperties);
    }

    @Override
    public boolean shouldApply(Options options, Set&lt;Feature&gt; selectedFeatures) {
        return true;
    }

    @Override
    public String getName() {
        return "entry-point";
    }

    @Override
    public String getDescription() {
        return "It generates a Hello World Maven and Gradle project";
    }

    @Override
    public boolean isVisible() {
        return false;
    }

    @Override
    public void apply(GeneratorContext generatorContext) {
        ModuleContext module = generatorContext.getRootModule();
        Options options = generatorContext.getOptions();
        populateModuleAttributes(module, options);
    }

    private void populateModuleAttributes(ModuleContext module, Options options) {
        module.moduleAttributes()
            .setCoordinate(Dependency.builder()
                .groupId(options.group())
                .artifactId(options.artifact())
                .version(options.version())
                .build());
    }
}</code></pre>
</div>
</div>

<h2 id="cli"><a class="anchor" href="#cli"></a>5.8 Project Generation in a Command Line Application</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-projectgen/edit/0.0.x/src/main/docs/guide/demo/cli.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>Generate projects in a command line application is a common use case of project generation.
The following example shows a Micronaut CLI application which generates a project:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package io.micronaut.projectgen.demo;

import io.micronaut.projectgen.core.buildtools.BuildTool;
import io.micronaut.projectgen.core.buildtools.gradle.GradleDsl;
import io.micronaut.projectgen.core.generator.ProjectGenerator;
import io.micronaut.projectgen.core.options.GenericOptionsBuilder;
import io.micronaut.projectgen.core.options.JdkVersion;
import io.micronaut.projectgen.core.options.Options;
import picocli.CommandLine;
import picocli.CommandLine.Command;
import jakarta.inject.Inject;

import java.io.File;
import java.util.List;

@Command(
    name = "create",
    description = "Create a new project"
)
public class CreateCommand implements Runnable {
    @CommandLine.Option(
        names = { "--output", "-o" },
        required = true,
        description = "The output folder where the project file will be generated")
    private File outputDir;

    @CommandLine.Option(
        names = { "--features", "-f" },
        description = "Comma-separated list of features to include",
        split = ",")
    private List&lt;String&gt; features;

    @Inject
    ProjectGenerator projectGenerator;

    @Override
    public void run() {
        if (!outputDir.exists() || !outputDir.isDirectory()) {
            System.err.println("Provided path is not an existing directory: " + outputDir);
        } else {
            Options options = GenericOptionsBuilder.builder()
                .name("demo")
                .packageName("com.example")
                .group("io.micronaut.projectgen")
                .artifact("demo-project")
                .version("1.0.0")
                .features(features)
                .buildTools(List.of(BuildTool.GRADLE, BuildTool.MAVEN))
                .gradleDsl(GradleDsl.KOTLIN)
                .java(JdkVersion.JDK_21)
                .build();
            projectGenerator.writeTo(options, outputDir);
        }
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>To generate a project into a folder, you can use the <a href="../api/io/micronaut/projectgen/core/generator/ProjectGenerator.html">ProjectGenerator</a> API.</td>
</tr>
</table>
</div>

<h2 id="httpServerDemo"><a class="anchor" href="#httpServerDemo"></a>5.9 Project Generation in a HTTP Server</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-projectgen/edit/0.0.x/src/main/docs/guide/demo/httpServerDemo.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>The following controller renders an HTML with a button that downloads a ZIP file with a project:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package io.micronaut.projectgen.demo;

import io.micronaut.http.MediaType;
import io.micronaut.http.annotation.Controller;
import io.micronaut.http.annotation.Get;
import io.micronaut.http.annotation.Produces;

@Controller
class HomeController {

    @Get
    @Produces(MediaType.TEXT_HTML)
    String index() {
        return """
            &lt;!DOCTYPE html&gt;
            &lt;html&gt;
            &lt;head&gt;
            &lt;title&gt;Download Project&lt;/title&gt;
            &lt;/head&gt;
            &lt;body&gt;
            &lt;form action="/api/v1/download/zip" method="POST"&gt;
                &lt;fieldset&gt;
                    &lt;input type="hidden" name="name" value="demo"/&gt;
                    &lt;input type="hidden" name="packageName" value="com.example"/&gt;
                    &lt;input type="hidden" name="group" value="io.micronaut.projectgen"/&gt;
                    &lt;input type="hidden" name="artifact" value="demo-project"/&gt;
                    &lt;input type="hidden" name="version" value="1.0.0"/&gt;
                    &lt;input type="hidden" name="build" value="MAVEN,GRADLE"/&gt;
                    &lt;input type="hidden" name="gradleDsl" value="KOTLIN"/&gt;
                    &lt;input type="hidden" name="java" value="21"/&gt;
                    &lt;input type="checkbox" name="features" value="hello-world-test"/&gt; Generate Test&lt;br/&gt;
                    &lt;input type="submit" value="Download" /&gt;
                &lt;/fieldset&gt;

            &lt;/form&gt;
            &lt;/body&gt;
            &lt;/html&gt;
            """;
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
To render server-side HTML, use <a href="https://micronaut-projects.github.io/micronaut-views/latest/guide/">Micronaut Views</a>.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package io.micronaut.projectgen.demo;

import io.micronaut.http.HttpRequest;
import io.micronaut.http.MediaType;
import io.micronaut.http.client.BlockingHttpClient;
import io.micronaut.http.client.HttpClient;
import io.micronaut.http.client.annotation.Client;
import io.micronaut.projectgen.core.buildtools.BuildTool;
import io.micronaut.projectgen.core.buildtools.gradle.GradleDsl;
import io.micronaut.projectgen.core.options.JdkVersion;
import io.micronaut.test.extensions.junit5.annotation.MicronautTest;
import org.json.JSONException;
import org.junit.jupiter.api.Test;
import org.skyscreamer.jsonassert.JSONAssert;
import org.skyscreamer.jsonassert.JSONCompareMode;

import java.util.HashMap;
import java.util.List;
import java.util.Map;

import static org.junit.jupiter.api.Assertions.assertDoesNotThrow;
import static org.junit.jupiter.api.Assertions.assertNotNull;

@MicronautTest
class FeaturesTest {

    @Test
    void testFeaturesEndpoint(@Client("/") HttpClient httpClient) throws JSONException {
        BlockingHttpClient client = httpClient.toBlocking();

        Map&lt;String, Object&gt; form = new HashMap&lt;&gt;();
        form.put("name", "demo");
        form.put("packageName", "com.example");
        form.put("group", "io.micronaut.projectgen");
        form.put("artifact", "demo-project");
        form.put("version", "1.0.0");
        form.put("features", "hello-world-test");
        form.put("build", List.of(BuildTool.MAVEN, BuildTool.GRADLE));
        form.put("gradleDsl", GradleDsl.KOTLIN);
        form.put("java", JdkVersion.JDK_21);

        HttpRequest&lt;?&gt; request = HttpRequest.POST("/api/v1/features", form)
            .contentType(MediaType.APPLICATION_FORM_URLENCODED_TYPE);
        String json = assertDoesNotThrow(() -&gt; client.retrieve(request));
        assertNotNull(json);
        String expected = """
            {
                "features":
                    [
                        {
                            "name":"hello-world-test",
                            "title":"Add Test",
                            "description":"Add Unit tests with Junit5 dependency",
                            "preview":false,
                            "community":false
                         }
                    ]
            }
            """;
        JSONAssert.assertEquals(
            expected, json, JSONCompareMode.LENIENT);
    }
}</code></pre>
</div>
</div>

<h2 id="test"><a class="anchor" href="#test"></a>5.10 Test Project Generation</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-projectgen/edit/0.0.x/src/main/docs/guide/demo/test.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>You can test the project generation easily:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package io.micronaut.projectgen.demo;

import io.micronaut.projectgen.core.buildtools.BuildTool;
import io.micronaut.projectgen.core.buildtools.Scope;
import io.micronaut.projectgen.core.io.PreviewGenerator;
import io.micronaut.projectgen.core.options.Options;
import io.micronaut.projectgen.test.BuildTestVerifier;
import io.micronaut.projectgen.test.GradleBuildTestVerifier;
import io.micronaut.projectgen.test.MavenBuildTestVerifier;
import io.micronaut.test.extensions.junit5.annotation.MicronautTest;
import org.junit.jupiter.api.Test;

import java.util.Collections;
import java.util.List;
import java.util.Map;

import static org.junit.jupiter.api.Assertions.assertEquals;
import static org.junit.jupiter.api.Assertions.assertFalse;
import static org.junit.jupiter.api.Assertions.assertTrue;

@MicronautTest(startApplication = false)
class ProjectGenTest {

    @Test
    void testProjectGeneration(PreviewGenerator previewGenerator) throws Exception {
        Options options = OptionsFactory.create(Collections.emptyList());
        Map&lt;String, String&gt; project = previewGenerator.generate(options);
        assertTrue(project.containsKey("mvnw"));
        assertTrue(project.containsKey("mvnw.bat"));
        assertTrue(project.containsKey(".mvn/wrapper/maven-wrapper.jar"));
        assertTrue(project.containsKey(".mvn/wrapper/maven-wrapper.properties"));
        assertTrue(project.containsKey("pom.xml"));
        assertTrue(project.containsKey("src/main/java/com/example/HelloWorld.java"));
        assertFalse(project.containsKey("src/test/java/com/example/HelloWorldTest.java"));
        String pom = project.get("pom.xml");
        BuildTestVerifier verifier = new MavenBuildTestVerifier(pom, options.language());
        assertEquals("21", verifier.getProperty("maven.compiler.source"));
        assertEquals("21", verifier.getProperty("maven.compiler.target"));
        assertTrue(verifier.hasBuildPlugin("org.apache.maven.plugins", "maven-jar-plugin"));
        String buildGradleKts = project.get("build.gradle.kts");
        verifier = new GradleBuildTestVerifier(buildGradleKts, BuildTool.GRADLE, options.language(), options.testFramework());
        assertFalse(verifier.hasDependency("org.junit.jupiter", "junit-jupiter", Scope.TEST));
        assertTrue(verifier.hasBuildPlugin("java"));
        assertTrue(verifier.hasBuildPlugin("application"));
        assertTrue(project.containsKey("settings.gradle.kts"));
        String settings = project.get("settings.gradle.kts");
        assertEquals("""
        rootProject.name="demo"
        """, settings);
        assertTrue(project.containsKey("gradlew"));
        assertTrue(project.containsKey("gradlew.bat"));
        assertTrue(project.containsKey("gradle/wrapper/gradle-wrapper.jar"));
        assertTrue(project.containsKey("gradle/wrapper/gradle-wrapper.properties"));
        String gradleWrapperProperties = project.get("gradle/wrapper/gradle-wrapper.properties");
        assertTrue(gradleWrapperProperties.contains("8.14.2"));

        options = OptionsFactory.create(List.of("hello-world-test"));
        project = previewGenerator.generate(options);
        buildGradleKts = project.get("build.gradle.kts");
        assertTrue(project.containsKey("src/test/java/com/example/HelloWorldTest.java"));
        verifier = new GradleBuildTestVerifier(buildGradleKts, BuildTool.GRADLE, options.language(), options.testFramework());
        assertTrue(verifier.hasDependency("org.junit.jupiter", "junit-jupiter", Scope.TEST), buildGradleKts);

        assertTrue(project.containsKey("projectgen.properties"));
        String props = project.get("projectgen.properties");
        assertEquals("""
            artifact=demo-project
            java=JDK_21
            buildTools[0]=maven
            buildTools[1]=gradle
            gradleDsl=KOTLIN
            name=demo
            packageName=com.example
            version=1.0.0
            group=io.micronaut.projectgen
            """, props);
    }
}</code></pre>
</div>
</div>

<h1 id="repository"><a class="anchor" href="#repository"></a>6 Repository</h1>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-projectgen/edit/0.0.x/src/main/docs/guide/repository.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>You can find the source code of this project in this repository:</p>
</div>
<div class="paragraph">
<p><a href="https://github.com/micronaut-projects/micronaut-projectgen">https://github.com/micronaut-projects/micronaut-projectgen</a></p>
</div>

    </div>
</div>

<script type="text/javascript">

</script>
</body>
</html>
