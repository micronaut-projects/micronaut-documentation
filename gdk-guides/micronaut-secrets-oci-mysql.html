<!DOCTYPE html>
<html lang="en"><head><style type="text/css">.truste_caIcon_display {display: block !important;}</style><style type="text/css">.truste_cursor_pointer {cursor: pointer;}.truste_border_none {border: none;}</style>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta property="og:image" content="https://graal.cloud/gdk/resources/img/graalvm.png">
    <meta name="twitter:widgets:border-color" content="#55acee">

    <link rel="stylesheet" href="https://graal.cloud/gdk/resources/lib/highlight/highlight.min.js">
    <script src="https://graal.cloud/gdk/resources/lib/highlight/highlight.min.js"></script>

    <title>Securely Store Database Connection Details in an Oracle Cloud Infrastructure Vault</title>
    <meta name="description" content="The Graal Development Kit for Micronaut (GDK) is a build of a curated set of Micronaut framework modules and their required libraries for building portable c...">
    <meta name="last_modified" content="2024-10-10 16:30:05 +0000">
    <meta name="last_built" content="2024-10-29 09:25:27 +0000">
    <link rel="stylesheet" href="https://graal.cloud/gdk/assets/main.css" >
    <link rel="apple-touch-icon" sizes="180x180" href="https://graal.cloud/gdk/resources/img/favicon/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="https://graal.cloud/gdk/resources/img/favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="https://graal.cloud/gdk/resources/img/favicon/favicon-16x16.png">
    <link rel="manifest" href="https://graal.cloud/gdk/resources/img/favicon/site.webmanifest">
    <link rel="stylesheet" type="text/css" href="https://graal.cloud/gdk/resources/styles/codicon.css" />
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="theme-color" content="#ffffff">
    <meta name="google-site-verification" content="-vRqwa9WYn6AaQGnl88xvrLw6ac4xoKVkZkhanmlRhU">
    <link rel="canonical" href="https://www.graal.cloud/gdk/gdk-modules/database/micronaut-data-jdbc-repository/">

    <!-- TODO: move to stylesheet -->
    <style>
        @media (min-width: 768px) {
            .content {
                padding-top: 60px;
            }
        }

        .colist table {
            border: 0;

            td {
                border: 0;
            }

            tr {
                border: 0;
            }
        }

        .imageblock {
            max-width: 50%;
        }

        main{
            padding-top: 50px !important;
        }

        .content{
            padding-top: 0;
        }

        ul.sectlevel0 > li > a:first-of-type {
            color: #F68831 !important;
            font-weight: 700;
        }

        ul.sectlevel1 > li > a {
            color: #dbe6ff;
            font-weight: 400 !important;
            padding-left: 20px;
            font-size: 14px;
        }

            .conum[data-value]::after {
                content: attr(data-value);
                display: inline-block;
                border: 1px solid;
                -webkit-border-radius: 50%;
                border-radius: 50%;
                text-align: center;
                font-size: .75em;
                width: 1.67em;
                height: 1.67em;
                line-height: 1.67em;
                font-family: "Open Sans", "DejaVu Sans", sans-serif;
                font-style: normal;
                font-weight: bold;
            }
            .conum[data-value]+b {
                display: none;
            }

        .sectlevel1 a.active {
            color: #F68831;
            font-weight: bold;
        }
        a.external {
            color: #d6d6d6   !important;
        }
        a.external:hover {
            color: white !important;
            background-color: #1e2631 !important;
        }
    </style>

    <!-- jQuery UI Tabs -->
    <link rel="stylesheet" href="//code.jquery.com/ui/1.14.0/themes/base/jquery-ui.css">
    <link rel="stylesheet" href="https://graal.cloud/gdk/resources/lib/jquery/jquery-ui.css">
    <script type="text/javascript" id="www-widgetapi-script" src="https://www.youtube.com/s/player/a8476471/www-widgetapi.vflset/www-widgetapi.js" async=""></script><script src="https://www.youtube.com/iframe_api"></script><script async="" src="https://tags.bkrtx.com/js/bk-coretag.js"></script><script src="https://graal.cloud/gdk/resources/lib/jquery/jquery-3.7.1.min.js"></script><script src="https://graal.cloud/gdk/resources/lib/bootstrap/js/bootstrap.min.js"></script><script src="https://graal.cloud/gdk/resources/lib/sticky-sidebar/resizeSensor.js"></script><script src="https://graal.cloud/gdk/resources/lib/sticky-sidebar/sticky-sidebar.min.js"></script><script async="" defer="" src="https://buttons.github.io/buttons.js"></script><script async="async" type="text/javascript" src="//consent.trustarc.com/notice?domain=oracle.com&amp;c=teconsent&amp;js=bb&amp;noticeType=bb&amp;text=true&amp;cdn=1&amp;pcookie&amp;gtm=1" crossorigin="" id="truste_0.9548969741402604"></script><script src="https://www.oracle.com/assets/truste-oraclelib.js"></script><script src="https://code.jquery.com/ui/1.14.0/jquery-ui.js"></script></head>
    <script>
        document.addEventListener("DOMContentLoaded", function () {
        const menuLinks = document.querySelectorAll(".sectlevel1 a");

        function highlightMenu() {
            let currentSection = null;

            menuLinks.forEach(link => {
                const section = document.querySelector(link.getAttribute("href"));
                if (section) {
                    const rect = section.getBoundingClientRect();
                    if (rect.top >= 0 && rect.top < window.innerHeight / 2) {
                        currentSection = link;
                    }
                }
            });

            menuLinks.forEach(link => link.classList.remove("active"));

            if (currentSection) {
                currentSection.classList.add("active");
            }
        }

        window.addEventListener("scroll", highlightMenu);
        highlightMenu();

        });</script>
<!-- Add TRUSTe Consent Script and Analytics -->


<!-- jQuery UI Tabs -->

<body class="">
<!-- Start SiteCatalyst code -->
<script language="JavaScript" src="https://www.oracle.com/us/assets/metrics/ora_otn.js"></script><script type="text/javascript" src="https://www.oracleimg.com/us/assets/metrics/ora_code_otn.js"></script><script type="text/javascript" src="https://www.oracleimg.com/us/assets/metrics/ora_code.js"></script>
<!-- End SiteCatalyst code -->

<div class="wrapper wrapper--nofooter">

    <header class="header header--content" role="banner">
        <nav class="menu">
            <div class="menu__row">
                <div>
                    <a href="/gdk/" class="activeMenuItem">
                        <img class="logo-mobile" src="https://graal.cloud/gdk/resources/img/gdk-logo-new.svg" alt="Graal Development Kit for Micronaut logo" style="margin-left: 0px;">
                    </a>
                </div>
                <div class="menu__container">
                    <ul class="menu__list">
                        <li class="menu__item">
                            <a href="/gdk/about/" class="menu__link">About</a>
                        </li>
                        <li class="menu__item">
                            <a href="/gdk/get-started/" class="menu__link">Get Started</a>
                        </li>
                        <li class="menu__item">
                            <div class="stack-container">
                                <a href="#" class="menu__link stack__header">Docs</a>
                                <div class="stack-menu-learn">
                                    <div class="stack-row">
                                        <div class="stack-column">
                                            <div class="stack__item">
                                                <img src="https://graal.cloud/gdk/resources/img/header-navigation/modules.svg">
                                                <a href="/gdk/modules/" class="item-line">Modules</a>
                                            </div>
                                            <div class="stack__item">
                                                <img src="https://graal.cloud/gdk/resources/img/header-navigation/guides.svg">
                                                <a href="/gdk/guides/" class="item-line">Guides</a>
                                            </div>
                                            <div class="stack__item">
                                                <img src="https://graal.cloud/gdk/resources/img/header-navigation/labs.svg">
                                                <a href="/gdk/hands-on-labs/" class="item-line">Hands-On Labs</a>
                                            </div>
                                            <div class="stack__item">
                                                <img src="https://graal.cloud/gdk/resources/img/header-navigation/tools.svg">
                                                <a href="/gdk/vscode-tools/" class="item-line">Tools</a>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </li>
                        <li class="menu__item">
                            <div class="stack-container">
                                <a href="#" class="menu__link stack__header">Graal Projects</a>
                                <div class="stack-menu">
                                    <div class="stack-row">
                                        <div class="stack-column">
                                            <div class="stack__item">
                                                <img src="https://graal.cloud/gdk/resources/img/header-navigation/graalstack.svg">
                                                <a href="/" class="item-line">Graal</a>
                                            </div>
                                            <div class="stack__item">
                                                <img src="https://graal.cloud/gdk/resources/img/header-navigation/graalvm.svg">
                                                <a href="https://graalvm.org/" class="item-line">GraalVM</a>
                                            </div>
                                            <div class="stack__item">
                                                <img src="https://graal.cloud/gdk/resources/img/header-navigation/graalos.svg">
                                                <a href="/graalos/" class="item-line">GraalOS</a>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </li>
                        <li class="menu__launch__mobile">
                            <a href="/gdk/launcher/" class="btn-launch btn btn-primary" target="blank">Create App</a>
                        </li>
                    </ul>
                </div>
                <div class="menu__launch">
                    <a href="/gdk/launcher/" class="btn-launch btn btn-primary" target="blank">Create App</a>
                </div>
            </div>

            <div role="button" class="menu-btn menu-btn--menu js-show-menu" tabindex="-1" title="sweet hamburger">
                <div class="hamburger">
                    <div class="inner"></div>
                </div>
            </div>
            <button aria-label="hamburger mobile menu" class="btn btn-mobile-menu js-show-menu">
                <div class="inner"></div>
            </button>
        </nav>


    </header>


    <main class="content" aria-label="Content">
        <div class="wrapper wrapper-content">
            <article>
                <div class="row d-flex flex-wrap">
                    <div class="col-sm-3 docsimpro col-bg">
                        <div class="sidebar-wrap is-affixed" style="height: 473px; position: relative;"><div class="inner-wrapper-sticky" style="position: fixed; top: 74px; left: 0px; width: 300px;">
                            <div class="sidebar">
                                <div class="menuabout">
                                    <img id="sidebarClose" src="https://graal.cloud/gdk/resources/img/arrow_sidebar(close).svg" alt="Expand or collapse sidebar" class="btn-color no-display">
                                    <img id="sidebarOpen" src="https://graal.cloud/gdk/resources/img/arrow_sidebar.svg" alt="Expand or collapse sidebar">
                                </div>

                                                                <div class="toc-floating">
                                <div class="toc-bullets">
                                    <li class="toc-bullets-main">
                                        <a href="/gdk/docs/gdk-modules/secrets/" class="_icon-book">
                                            Secrets
                                        </a>
                                    </li>
                                    <li class="toc-bullets-sub toc-bullets-highlight">
                                        <a href="/gdk/gdk-modules/secrets/micronaut-secrets-oci-mysql/" class="activeMenuItem">
                                            Securely Store Database Connection Details in an Oracle Cloud Infrastructure Vault
                                        </a>
                                    </li>
                                    <div id="toc" class="toc">
<div id="toctitle"></div>
<ul class="sectlevel1">
<li><a href="#create-the-application">1. Create the Application</a></li>
<li><a href="#create-an-oracle-mysql-database-instance">2. Create an Oracle MySQL Database Instance</a></li>
<li><a href="#create-a-compute-instance-and-configure-the-database">3. Create a Compute Instance and Configure the Database</a></li>
<li><a href="#create-an-oracle-cloud-infrastructure-vault-master-encryption-key-and-secrets">4. Create an Oracle Cloud Infrastructure Vault, Master Encryption Key, and Secrets</a></li>
<li><a href="#use-a-vault-with-micronaut">5. Use a Vault with Micronaut</a></li>
<li><a href="#set-up-oracle-cloud-authentication">6. Set Up Oracle Cloud Authentication</a></li>
<li><a href="#start-the-application">7. Start the Application</a></li>
<li><a href="#generate-a-native-executable-using-graalvm">8. Generate a Native Executable Using GraalVM</a></li>
<li><a href="#deploy-from-a-native-executable">9. Deploy from a Native Executable</a></li>
<li><a href="#clean-up-cloud-resources">10. Clean up Cloud Resources</a></li>
</ul>
</div>
                                </div>
                            </div>


                            </div>
                            <div class="resize-sensor" style="position: absolute; inset: 0px; overflow: hidden; z-index: -1; visibility: hidden;"><div class="resize-sensor-expand" style="position: absolute; left: 0; top: 0; right: 0; bottom: 0; overflow: hidden; z-index: -1; visibility: hidden;"><div style="position: absolute; left: 0px; top: 0px; transition: all 0s ease 0s; width: 100000px; height: 100000px;"></div></div><div class="resize-sensor-shrink" style="position: absolute; left: 0; top: 0; right: 0; bottom: 0; overflow: hidden; z-index: -1; visibility: hidden;"><div style="position: absolute; left: 0; top: 0; transition: 0s; width: 200%; height: 200%"></div></div></div></div></div>
                        <div class="resize-sensor" style="position: absolute; inset: 0px; overflow: hidden; z-index: -1; visibility: hidden;"><div class="resize-sensor-expand" style="position: absolute; left: 0; top: 0; right: 0; bottom: 0; overflow: hidden; z-index: -1; visibility: hidden;"><div style="position: absolute; left: 0px; top: 0px; transition: all 0s ease 0s; width: 100000px; height: 100000px;"></div></div><div class="resize-sensor-shrink" style="position: absolute; left: 0; top: 0; right: 0; bottom: 0; overflow: hidden; z-index: -1; visibility: hidden;"><div style="position: absolute; left: 0; top: 0; transition: 0s; width: 200%; height: 200%"></div></div></div></div>

                    <div class="col-sm-9 docsmod">
                        <div id="content-wrapper" class="docs-content docs-content--with-sidebar"><h1>Securely Store Database Connection Details in an Oracle Cloud Infrastructure Vault</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>This guide describes how to use the Graal Development Kit for Micronaut (GDK) to create an application that stores MySQL database connection details as secrets in an Oracle Cloud Infrastructure vault.</p>
</div>
<div class="paragraph">
<p>Instead of storing a database URL, username, or password in plain text or via environment variables, a <strong>secret manager</strong> such as <a href="https://docs.oracle.com/iaas/Content/KeyManagement/Concepts/keyoverview.htm">Oracle Cloud Infrastructure Vault</a> provides a convenient way to securely store and retrieve sensitive data.</p>
</div>
<div class="paragraph">
<p>This guide describes how to use a Vault to store and retrieve details for a MySQL database connection, and demonstrates how to use <a href="https://micronaut-projects.github.io/micronaut-oracle-cloud/latest/guide/#vault">Micronaut® integration with the Oracle Cloud Infrastructure Vault</a>.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>Note: If this is your first experience of using an Oracle Cloud Infrastructure Vault with Micronaut, please review the <a href="/gdk/gdk-modules/secret-management/micronaut-secrets-oci/">Securely Store Application Secrets in an Oracle Cloud Infrastructure Vault</a> first.
Unlike that guide, this guide describes how to use the Oracle Cloud Infrastructure <a href="https://docs.cloud.oracle.com/iaas/Content/API/SDKDocs/cliinstall.htm">Command Line Interface</a> (CLI) to set up your tenancy.</p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p><strong>Prerequisites</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>JDK 17 or higher. See <a href="/gdk/get-started/setting-up-desktop/">Setting up Your Desktop</a>.</p>
</li>
<li>
<p>An Oracle Cloud Infrastructure account. See <a href="/gdk/get-started/setting-up-cloud-accounts/">Setting up Your Cloud Accounts</a>.</p>
</li>
<li>
<p>An Oracle Cloud Infrastructure <a href="https://docs.oracle.com/iaas/Content/GSG/Concepts/concepts-account.htm#conceptcompartment">compartment</a> with appropriate permission granted to your Oracle Cloud Infrastructure user account to manage <code>secret-family</code>, <code>key-family</code>, and to deploy and manage a database in the compartment.</p>
</li>
<li>
<p>A Virtual Cloud Network (VCN) in Oracle Cloud Infrastructure with a single regional public subnet, which will be used by both Compute and MySQL Database instances.</p>
</li>
<li>
<p><a href="https://stedolan.github.io/jq/"><code>jq</code></a>: a lightweight and flexible command-line JSON processor.</p>
</li>
<li>
<p>A Docker-API compatible container runtime such as <a href="https://docs.rancherdesktop.io/getting-started/installation/">Rancher Desktop</a> or <a href="https://www.docker.io/gettingstarted/">Docker</a> installed to build a deployable GraalVM Native Executable.</p>
</li>
<li>
<p>The GDK CLI. See <a href="/gdk/get-started/setting-up-desktop/">Setting up Your Desktop</a>. (Optional.)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Follow the steps below to create the application from scratch. However, you can also download the completed example:</p>
</div>
<div class="gradle-maven-tabs ui-tabs ui-corner-all ui-widget ui-widget-content">
    <ul role="tablist" class="ui-tabs-nav ui-corner-all ui-helper-reset ui-helper-clearfix ui-widget-header">
        <li class="tabs-gradle ui-tabs-tab ui-corner-top ui-state-default ui-tabs-active ui-state-active" role="tab" tabindex="0" aria-controls="gradle" aria-labelledby="ui-id-1" aria-selected="true" aria-expanded="true"><a name="gradle" href="#gradle" tabindex="-1" class="ui-tabs-anchor" id="ui-id-1">Gradle</a></li>
        <li class="tabs-maven ui-tabs-tab ui-corner-top ui-state-default" role="tab" tabindex="-1" aria-controls="maven" aria-labelledby="ui-id-2" aria-selected="false" aria-expanded="false"><a name="maven" href="#maven" tabindex="-1" class="ui-tabs-anchor" id="ui-id-2">Maven</a></li>
    </ul>
    <div id="gradle" aria-labelledby="ui-id-1" role="tabpanel" class="ui-tabs-panel ui-corner-bottom ui-widget-content" aria-hidden="false">
        <a href="https://github.com/oracle/graal-dev-kit/releases/download/4.7.3.5/4.7.3.5_secret-management_oci-secrets-demo-java-gradle.zip">Gradle OCI Secret Management Example <img src="https://graal.cloud/gdk/resources/img/gdk_modules/download-archive.png" alt="Download completed example" class="download-img-guides"/></a>
    </div>
    <div id="maven" aria-labelledby="ui-id-2" role="tabpanel" class="ui-tabs-panel ui-corner-bottom ui-widget-content" aria-hidden="true" style="display: none;">
        <a href="https://github.com/oracle/graal-dev-kit/releases/download/4.7.3.5/4.7.3.5_secret-management_oci-secrets-demo-java-maven.zip">Maven OCI Secret Management Example <img src="https://graal.cloud/gdk/resources/img/gdk_modules/download-archive.png" alt="Download completed example" class="download-img-guides"/></a>
    </div>
</div>
<div class="paragraph">
<p>The application ZIP file will be downloaded in your default downloads directory. Unzip it and proceed to the next steps.</p>
</div>
<h4 id="a-note-regarding-your-development-environment" class="discrete">A note regarding your development environment</h4>
<div class="paragraph">
<p>Consider using Visual Studio Code, which provides native support for developing applications with the <a href="https://marketplace.visualstudio.com/items?itemName=oracle-labs-graalvm.graal-cloud-native-pack">Graal Development Kit for Micronaut Extension Pack</a>.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>Note: If you use IntelliJ IDEA, <a href="/gdk/resources/img/annotationprocessorsintellij.png">enable annotation processing</a>.</p>
</div>
</blockquote>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>Windows platform: The GDK guides are compatible with Gradle only. Maven support is coming soon.</p>
</div>
</blockquote>
</div>
</div>
</div>
<div class="sect1">
<h2 id="create-the-application">1. Create the Application</h2>
<div class="sectionbody">
<p>Create an application using the GDK Launcher.</p>
<ol>
    <li>
        <p>Open the <a href="https://graal.cloud/gdk/launcher/?advanced=true" target="_blank">GDK Launcher in advanced mode</a>.</p>
    </li>
    <li>Create a new project using the following selections.
        <ul>
            <li><strong>Project Type</strong>: <em>Application</em> (Default)</li>
            <li><strong>Project Name</strong>: <em>oci-secrets-demo</em></li>
            <li><strong>Base Package</strong>: <em>com.example</em> (Default)</li>
            <li><strong>Clouds</strong>: <em>OCI</em></li>
            <li><strong>Build Tool</strong>: <em>Gradle (Groovy)</em> or <em>Maven</em></li>
            <li><strong>Language</strong>: <em>Java</em> (Default)</li>
            <li><strong>Test Framework</strong>: <em>JUnit</em> (Default)</li>
            <li><strong>Java Version</strong>: <em>17</em> (Default)</li>
            <li><strong>Micronaut Version</strong>: (Default)</li>
            <li><strong>Cloud Services</strong>: <em>Secret Management</em>, <em>Database</em></li>
            <li><strong>Features</strong>: <em>GraalVM Native Image</em> (Default)</li>
            <li><strong>Sample Code</strong>: <em>Yes</em> (Default)</li>
        </ul>
    </li>
    <li>Click <strong>Generate Project</strong>, then click <strong>Download Zip</strong>. The GDK Launcher creates an application with the package <code>com.example</code> in a directory named <em>oci-secrets-demo</em>. The application ZIP file will be downloaded to your default downloads directory. Unzip it, open it in your code editor, and proceed to the next steps.</li>
</ol>
<div class="paragraph">
<p>Alternatively, use the  <a href="/gdk/get-started/using-gdk-cli/">GDK CLI</a> as follows:</p>
</div>
<div class="gradle-maven-tabs ui-tabs ui-corner-all ui-widget ui-widget-content">
    <ul role="tablist" class="ui-tabs-nav ui-corner-all ui-helper-reset ui-helper-clearfix ui-widget-header">
        <li class="tabs-gradle ui-tabs-tab ui-corner-top ui-state-default ui-tabs-active ui-state-active" role="tab" tabindex="0" aria-controls="gradle" aria-labelledby="ui-id-1" aria-selected="true" aria-expanded="true"><a name="gradle" href="#gradle" tabindex="-1" class="ui-tabs-anchor" id="ui-id-1">Gradle</a></li>
        <li class="tabs-maven ui-tabs-tab ui-corner-top ui-state-default" role="tab" tabindex="-1" aria-controls="maven" aria-labelledby="ui-id-2" aria-selected="false" aria-expanded="false"><a name="maven" href="#maven" tabindex="-1" class="ui-tabs-anchor" id="ui-id-2">Maven</a></li>
    </ul>
    <div id="gradle" aria-labelledby="ui-id-1" role="tabpanel" class="ui-tabs-panel ui-corner-bottom ui-widget-content" aria-hidden="false">
        <pre><code class="language-bash hljs" data-highlighted="yes">gdk create-app com.example.oci-secrets-demo \
 --clouds=oci \
 --services=secretmanagement,database \
 --features=graalvm \
 --build=gradle \
 --jdk=17  \
 --lang=java</code><button>Copy</button></pre>
    </div>
    <div id="maven" aria-labelledby="ui-id-2" role="tabpanel" class="ui-tabs-panel ui-corner-bottom ui-widget-content" aria-hidden="true" style="display: none;">
        <pre><code class="language-bash hljs" data-highlighted="yes">gdk create-app com.example.oci-secrets-demo \
 --clouds=oci \
 --services=secretmanagement,database \
 --features=graalvm \
 --build=maven \
 --jdk=17  \
 --lang=java</code><button>Copy</button></pre>
    </div>
</div>
<div class="paragraph">
<p>Open the <em>micronaut-cli.yml</em> file, you can see what features are packaged with the application:</p>
</div>
<pre><code class="language-bash hljs" data-highlighted="yes">features: [app-name, data, data-jdbc, flyway, gdk-bom, gdk-license, gdk-oci-cloud-app, gdk-oci-database, gdk-oci-secretmanagement, graalvm, http-client, java, java-application, jdbc-hikari, junit, logback, maven, maven-enforcer-plugin, micronaut-http-validation, mysql, netty-server, oracle-cloud-vault, properties, readme, serialization-jackson, shade, static-resources, test-resources, validation]</code><button>Copy</button></pre>
<div class="paragraph">
<p>The GDK Launcher creates a multi-module project with two subprojects: <strong>oci</strong> for Oracle Cloud, and <strong>lib</strong> for common code and configuration shared across cloud platforms.
You develop the application logic in the <strong>lib</strong> subproject, and keep the
Oracle Cloud-specific configurations in the <strong>oci</strong> subproject.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="create-an-oracle-mysql-database-instance">2. Create an Oracle MySQL Database Instance</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Create a MySQL database using the <a href="/gdk/gdk-modules/database/micronaut-mysql-database-oci/">Create and Connect a Micronaut Application to an Oracle Cloud Infrastructure MySQL Database</a> guide.
Follow the steps in <strong>2</strong> (<em>Create an Oracle MySQL Database Instance</em>).</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="create-a-compute-instance-and-configure-the-database">3. Create a Compute Instance and Configure the Database</h2>
<div class="sectionbody">
<div class="paragraph">
<p>There is no direct way to externally <a href="https://docs.oracle.com/iaas/mysql-database/doc/connecting-db-system.html">connect to a MySQL database</a> in Oracle Cloud Infrastructure, so you need to create a Compute instance (virtual machine) in Oracle Cloud Infrastructure.</p>
</div>
<div class="paragraph">
<p>Create a Compute instance using the <a href="/gdk/gdk-modules/database/micronaut-mysql-database-oci/">Create and Connect a Micronaut Application to an Oracle Cloud Infrastructure MySQL Database</a> guide.
Follow the steps in section <strong>3</strong> (<em>Create a Compute Instance</em>).</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>Note: Use the same subnet as the one containing the MySQL database (otherwise the application will not be able to access the database).</p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>Configure your database by following the steps in section <strong>4</strong> (<em>Configure a MySQL Database</em>).</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="create-an-oracle-cloud-infrastructure-vault-master-encryption-key-and-secrets">4. Create an Oracle Cloud Infrastructure Vault, Master Encryption Key, and Secrets</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Before you can create a secret, you require a Vault (to hold the secret) and a master encryption key (to secure the secret).</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>Note: In this guide, you create all the Oracle Cloud Infrastructure resources in the same compartment. However, the best practice is to have a one Vault in a compartment (managed by an administrator)&mdash;application owners manage their application secrets in their individual compartments.</p>
</div>
</blockquote>
</div>
<div class="sect2">
<h3 id="create-a-vault">4.1. Create a Vault</h3>
<div class="paragraph">
<p>Create a Vault using the Oracle Cloud Infrastructure CLI.</p>
</div>
<div class="paragraph">
<p>The <code>create</code> command requires three parameters: compartment OCID, display name, and Vault type.
(See <a href="https://docs.oracle.com/iaas/tools/oci-cli/latest/oci_cli_docs/cmdref/kms.html">Key Management</a> for more information.)</p>
</div>
<div class="paragraph">
<p>Use the same compartment as the one you used for your database, above.
You should have saved the compartment OCID as the value of the environment variable <code>$COMPARTMENT_ID</code>.</p>
</div>
<div class="paragraph">
<p>Choose a display name (1-100 characters) and a Vault type, either <code>DEFAULT</code> or <code>VIRTUAL_PRIVATE</code>.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>Note: Choose <code>DEFAULT</code> to avoid the cost of a virtual private Vault.</p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>Run the <code>create</code> command, substituting the display name and Vault type, as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">oci kms management vault create -c $COMPARTMENT_ID \
    --display-name gdk_guide_vault \
    --vault-type DEFAULT \
    | jq -r '.data.id'</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>jq</code> utility extracts the OCID of the Vault from the <code>id</code> property in the response; this is the unique identifier for your Vault which you will need later.
Store the OCID as the value of the <code>VAULT_ID</code> environment variable:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">export VAULT_ID=ocid1.vault.oc1.iad.b5re3....abuwcljryp5dmxbu3si7...</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="create-a-master-encryption-key">4.2. Create a Master Encryption Key</h3>
<div class="paragraph">
<p>To <a href="https://docs.oracle.com/iaas/Content/KeyManagement/Tasks/managingkeys.htm">create a Master Encryption Key</a>, you need the Vault&#8217;s management endpoint URL.
It is not in the response from the Vault <code>create</code> command, so run the <a href="https://docs.oracle.com/iaas/tools/oci-cli/latest/oci_cli_docs/cmdref/kms/management/vault/get.html">get command</a>, as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">oci kms management vault get --vault-id $VAULT_ID</code></pre>
</div>
</div>
<div class="paragraph">
<p>The response to the command should look like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "data": {
    "compartment-id": "ocid1.tenancy.oc1..aaaaaaaaixksuiqo3rx6...",
    "crypto-endpoint": "https://b5re3...-crypto.kms.us-ashburn-1.oraclecloud.com",
    ...
    "display-name": "gdk_guide_vault",
    "id": "ocid1.vault.oc1.iad.b5re3....abuwcljryp5dmxbu3si7...",
    "is-primary": true,
    "lifecycle-state": "ACTIVE",
    "management-endpoint": "https://b5re3...-management.kms.us-ashburn-1.oraclecloud.com",
    ...
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Wait a few minutes for the Vault to be provisioned. Re-run the command until the value of <code>lifecycle-state</code> is <code>ACTIVE</code>.
The value of the <code>management-endpoint</code> property provides the URL.</p>
</div>
<div class="paragraph">
<p>Store the URL as the value of the <code>VAULT_ENDPOINT</code> environment variable:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">export VAULT_ENDPOINT=https://b5re3...-management.kms.us-ashburn-1.oraclecloud.com</code></pre>
</div>
</div>
<div class="paragraph">
<p>Choose a name for the key, such as "gdk-guide-encryption-key", and a "Protection Mode", either <code>SOFTWARE</code> or <code>HSM</code>.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>Note: Choose <code>SOFTWARE</code> to avoid the cost of using a hardware security module (HSM).</p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>Use the <code>AES</code> key shape algorithm and a key length of 32 (256 bits).</p>
</div>
<div class="paragraph">
<p>Run the <a href="https://docs.oracle.com/iaas/tools/oci-cli/latest/oci_cli_docs/cmdref/kms/management/key/create.html"><code>create</code></a> command, substituting the display name, protection mode, key shape, and management endpoint, as shown below. (Use the same compartment OCID as before.)</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">oci kms management key create -c $COMPARTMENT_ID \
    --display-name gdk-guide-encryption-key \
    --protection-mode SOFTWARE \
    --key-shape '{"algorithm":"AES","length":"32"}' \
    --endpoint $VAULT_ENDPOINT \
    | jq -r '.data.id'</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you use Windows, escape the inner double quotes in the value for <code>key-shape</code>: <code>'{\"algorithm\":\"AES\",\"length\":\"32\"}</code></p>
</div>
<div class="paragraph">
<p>The <code>jq</code> utility extracts the <code>id</code> value from the response:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">ocid1.key.oc1.iad.b5re3.....abuwcljrcuie7t6gctc6...</code></pre>
</div>
</div>
<div class="paragraph">
<p>Store the OCID as the value of the <code>VAULT_KEY_ID</code> environment variable:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">export VAULT_KEY_ID=ocid1.key.oc1.iad.b5re3.....abuwcljrcuie7t6gctc6...</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="create-secrets">4.3. Create Secrets</h3>
<div class="paragraph">
<p>In this guide you store values for the database username, password, and URL in a Vault by creating secrets for the properties named <code>datasources.default.username</code>, <code>datasources.default.password</code>, and <code>datasources.default.url</code>. You create the secrets in the same compartment as your other Oracle Cloud Infrastructure resources.</p>
</div>
<div class="sect3">
<h4 id="create-a-secret-named-datasources-default-username">4.3.1. Create a Secret named <code>datasources.default.username</code></h4>
<div class="paragraph">
<p>The first secret is for the database username, named <code>datasources.default.username</code>.</p>
</div>
<div class="paragraph">
<p>You must Base64-encode the contents of a secret.
You can encode the contents programmatically, for example via the Java statement <code>Base64.getEncoder().encodeToString("the value".getBytes())</code>, or use an online tool such as <a href="https://www.base64encode.org/" class="bare">https://www.base64encode.org/</a>.</p>
</div>
<div class="paragraph">
<p>Run the <a href="https://docs.oracle.com/iaas/tools/oci-cli/latest/oci_cli_docs/cmdref/vault/secret/create-base64.html"><code>create-base64</code></a> command substituting the secret name and Base64-encoded secret.
(If you use "guide_user" as the database username, the Base64-encoded version is "Z3VpZGVfdXNlcg==&quot;.)</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">oci vault secret create-base64 -c $COMPARTMENT_ID \
    --key-id $VAULT_KEY_ID \
    --vault-id $VAULT_ID \
    --secret-name datasources.default.username \
    --secret-content-content Z3VpZGVfdXNlcg==</code></pre>
</div>
</div>
<div class="paragraph">
<p>The response should look like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "data": {
    "compartment-id": "ocid1.compartment.oc1..aaaaaaaarkh3s2wcxbbm...",
    ...
    "id": "ocid1.vaultsecret.oc1.iad.amaaaaaafzr7royabqgz...",
    "key-id": "ocid1.key.oc1.iad.b5re3.....abuwcljrcuie7t6gctc6...",
    "lifecycle-state": "CREATING",
    "secret-name": "datasources.default.username",
    ...
    "vault-id": "ocid1.vault.oc1.iad.b5re3....abuwcljryp5dmxbu3si7..."
  }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="create-secret-named-datasources-default-password">4.3.2. Create Secret named: <code>datasources.default.password</code></h4>
<div class="paragraph">
<p>Create a second secret with the name <code>datasources.default.password</code>.
Set the contents of the section as the Base64-encoded version of the database user password you chose earlier.</p>
</div>
</div>
<div class="sect3">
<h4 id="create-secret-named-datasources-default-url">4.3.3. Create Secret named: <code>datasources.default.url</code></h4>
<div class="paragraph">
<p>Create a third secret with the name <code>datasources.default.url</code>.
The URL is <code>jdbc:mysql://&lt;MySQL IP address&gt;:3306/&lt;MySQL Database Name&gt;</code> substituting the private IP address and name of your MySQL database.
Set the contents of the secret as the Base64-encoded version of the URL.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="use-a-vault-with-micronaut">5. Use a Vault with Micronaut</h2>
<div class="sectionbody">
<div class="paragraph">
<p><a href="https://micronaut-projects.github.io/micronaut-oracle-cloud/latest/guide/">Micronaut Oracle Cloud</a> provides integration between Micronaut applications and Oracle Cloud Infrastructure services, including using <a href="https://micronaut-projects.github.io/micronaut-oracle-cloud/latest/guide/#vault">Vault</a> as a distributed configuration source.
The GDK Launcher added the appropriate dependencies to your build file when you selected the <strong>Database</strong> and <strong>Secret Management</strong> services in the GDK Launcher.</p>
</div>
<div class="sect2">
<h3 id="modify-the-micronaut-configuration">5.1. Modify the Micronaut Configuration</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The Micronaut <strong>bootstrap</strong> configuration file contains the properties to authenticate your application against Oracle Cloud Infrastructure, as well as the compartment OCIDs of the Vault and secrets.</p>
<div class="paragraph">
<p>Modify the file named <em>oci/src/main/resources/bootstrap-oraclecloud.properties</em> so that its contents matches the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties"> micronaut.application.name=oci-secrets-demo-oci
 micronaut.config-client.enabled=true
 <i class="conum" data-value="1"></i><b>(1)</b>
 oci.config.instance-principal.enabled=true
 oci.vault.config.enabled=true
 <i class="conum" data-value="2"></i><b>(2)</b>
 oci.vault.vaults[0].compartment-ocid=${COMPARTMENT_ID}
 <i class="conum" data-value="3"></i><b>(3)</b>
 oci.vault.vaults[0].ocid=${VAULT_ID}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>1</strong> Use <a href="https://micronaut-projects.github.io/micronaut-oracle-cloud/latest/guide/#instance-principals">Instance Principal authentication</a> to enable the Micronaut application to access secrets in the Vault.</p>
</div>
<div class="paragraph">
<p><strong>2</strong> Set the value of the <code>oci.vault.vaults[0].compartment-ocid</code> property with the OCID of the compartment where you created the secrets.</p>
</div>
<div class="paragraph">
<p><strong>3</strong> Set the value of the <code>oci.vault.vaults[0].ocid</code> property with the OCID you saved when creating the Vault.</p>
</div>
</li>
<li>
<p>The Micronaut <strong>application</strong> configuration file contains the properties for your database connection.
Modify the file named <em>oci/src/main/resources/application.properties</em> so that its contents matches the following:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">datasources.default.db-type=mysql
datasources.default.dialect=MYSQL
datasources.default.driver-class-name=com.mysql.cj.jdbc.Driver
flyway.datasources.default.enabled=true
oci.config.profile=DEFAULT</code></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="set-up-oracle-cloud-authentication">6. Set Up Oracle Cloud Authentication</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In step <a href="#modify-the-micronaut-configuration">above</a> above, you modified the Micronaut <strong>bootstrap</strong> configuration file to use <a href="https://micronaut-projects.github.io/micronaut-oracle-cloud/latest/guide/#instance-principals">Instance Principal authentication</a> so that the application can retrieve secrets.
To use this from your compute instance, create a dynamic group and add a policy statement granting permission.</p>
</div>
<div class="sect2">
<h3 id="create-a-dynamic-group">6.1. Create a Dynamic Group</h3>
<div class="paragraph">
<p>Choose a group name, such as "gdk-guide-dg", and a matching rule (the logic that will be used to determine group membership).
For this guide, use a broad rule that includes all compute instances in your compartment: <code>ALL {instance.compartment.id = 'ocid1.compartment.oc1..aaaaaaaarkh3s2wcxbbm…'}</code> replacing <code>ocid1.compartment.oc1..aaaaaaaarkh3s2wcxbbm…</code> with the compartment OCID.</p>
</div>
<div class="paragraph">
<p>Run the <a href="https://docs.oracle.com/iaas/tools/oci-cli/latest/oci_cli_docs/cmdref/iam/dynamic-group/create.html"><code>create</code></a> command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">oci iam dynamic-group create \
   --name mn-guide-dg \
   --description mn-guide-dg \
   --matching-rule "ALL {instance.compartment.id = 'ocid1.compartment.oc1..aaaaaaaarkh3s2wcxbbm...'}" \
   | jq -r '.data."compartment-id"'</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>jq</code> utility extracts the <code>compartment-id</code> value from the response. Store it (the tenancy OCID) as the value of the <code>T</code> environment variable:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">export T=ocid1.tenancy.oc1..aaaaaaaaud4g4e5ovjaw...</code></pre>
</div>
</div>
<div class="paragraph">
<p>For more information, see <a href="https://docs.oracle.com/iaas/Content/Identity/Tasks/managingdynamicgroups.htm">Dynamic Groups</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="add-dynamic-group-policy-statements">6.2. Add Dynamic Group Policy Statements</h3>
<div class="paragraph">
<p>Create a policy to grant read access to Vault secrets in your compartment. Create the policy in the root compartment (the tenancy), use the tenancy OCID saved from the dynamic group creation response.</p>
</div>
<div class="paragraph">
<p>Run the <a href="https://docs.oracle.com/iaas/tools/oci-cli/latest/oci_cli_docs/cmdref/iam/policy/create.html"><code>create</code></a> command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">oci iam policy create -c $T \
    --name gdk-guide-policy \
    --description gdk-guide-policy \
    --statements '["allow dynamic-group gdk-guide-dg to read secret-family in tenancy"]' \
    | jq -r '.data.id'</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>jq</code> utility extracts the policy OCID from the <code>id</code> property in the response. Store it as the value of the <code>POLICY_ID</code> environment variable:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">export POLICY_ID=ocid1.policy.oc1..aaaaaaaau7uhwxr3ynlr...</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="start-the-application">7. Start the Application</h2>
<div class="sectionbody">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create an executable JAR file including all application&#8217;s dependencies:</p>
<div class="gradle-maven-tabs ui-tabs ui-corner-all ui-widget ui-widget-content">
    <ul role="tablist" class="ui-tabs-nav ui-corner-all ui-helper-reset ui-helper-clearfix ui-widget-header">
        <li class="tabs-gradle ui-tabs-tab ui-corner-top ui-state-default ui-tabs-active ui-state-active" role="tab" tabindex="0" aria-controls="gradle" aria-labelledby="ui-id-1" aria-selected="true" aria-expanded="true"><a name="gradle" href="#gradle" tabindex="-1" class="ui-tabs-anchor" id="ui-id-1">Gradle</a></li>
        <li class="tabs-maven ui-tabs-tab ui-corner-top ui-state-default" role="tab" tabindex="-1" aria-controls="maven" aria-labelledby="ui-id-2" aria-selected="false" aria-expanded="false"><a name="maven" href="#maven" tabindex="-1" class="ui-tabs-anchor" id="ui-id-2">Maven</a></li>
    </ul>
    <div id="gradle" aria-labelledby="ui-id-1" role="tabpanel" class="ui-tabs-panel ui-corner-bottom ui-widget-content" aria-hidden="false">
        <pre><code class="language-bash hljs" data-highlighted="yes">./gradlew :oci:shadowJar</code><button>Copy</button></pre>
    </div>
    <div id="maven" aria-labelledby="ui-id-2" role="tabpanel" class="ui-tabs-panel ui-corner-bottom ui-widget-content" aria-hidden="true" style="display: none;">
        <pre><code class="language-bash hljs" data-highlighted="yes">./mvnw install -pl lib -am
./mvnw package -pl oci -DskipTests</code><button>Copy</button></pre>
    </div>
</div>
</li>
<li>
<p>From a local console, copy the JAR file from your computer to the compute instance using <code>scp</code>:</p>
<div class="gradle-maven-tabs ui-tabs ui-corner-all ui-widget ui-widget-content">
    <ul role="tablist" class="ui-tabs-nav ui-corner-all ui-helper-reset ui-helper-clearfix ui-widget-header">
        <li class="tabs-gradle ui-tabs-tab ui-corner-top ui-state-default ui-tabs-active ui-state-active" role="tab" tabindex="0" aria-controls="gradle" aria-labelledby="ui-id-1" aria-selected="true" aria-expanded="true"><a name="gradle" href="#gradle" tabindex="-1" class="ui-tabs-anchor" id="ui-id-1">Gradle</a></li>
        <li class="tabs-maven ui-tabs-tab ui-corner-top ui-state-default" role="tab" tabindex="-1" aria-controls="maven" aria-labelledby="ui-id-2" aria-selected="false" aria-expanded="false"><a name="maven" href="#maven" tabindex="-1" class="ui-tabs-anchor" id="ui-id-2">Maven</a></li>
    </ul>
    <div id="gradle" aria-labelledby="ui-id-1" role="tabpanel" class="ui-tabs-panel ui-corner-bottom ui-widget-content" aria-hidden="false">
        <pre><code class="language-bash hljs" data-highlighted="yes">scp -i /path/to/ssh-key-*.key path/to/oci-secrets-demo/oci/build/libs/oci-1.0-SNAPSHOT-all.jar opc@[COMPUTE_INSTANCE_PUBLIC_IP]:~/application.jar</code><button>Copy</button></pre>
    </div>
    <div id="maven" aria-labelledby="ui-id-2" role="tabpanel" class="ui-tabs-panel ui-corner-bottom ui-widget-content" aria-hidden="true" style="display: none;">
        <pre><code class="language-bash hljs" data-highlighted="yes">scp -i /path/to/ssh-key-*.key path/to/oci-secrets-demo/oci/target/oci-1.0-SNAPSHOT.jar opc@[COMPUTE_INSTANCE_PUBLIC_IP]:~/application.jar</code><button>Copy</button></pre>
    </div>
</div>
</li>
<li>
<p>Once copied, connect to the compute instance (if it has disconnected by now):</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">ssh -i /path/to/ssh-key-*.key opc@[COMPUTE_INSTANCE_PUBLIC_IP]</code></pre>
</div>
</div>
</li>
<li>
<p>Start the application:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">java -jar application.jar</code></pre>
</div>
</div>
</li>
<li>
<p>From a local console, run this command to test that you can create and store a new <code>Genre</code> in the database:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">curl -X "POST" "http://[COMPUTE_INSTANCE_PUBLIC_IP]:8080/genres" \
      -H 'Content-Type: application/json; charset=utf-8' \
      -d $'{ "name": "music" }'</code></pre>
</div>
</div>
<div class="paragraph">
<p>Then list the genres:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">curl [COMPUTE_INSTANCE_PUBLIC_IP]:8080/genres/list</code></pre>
</div>
</div>
<div class="paragraph">
<p>The response should look like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{"id":1,"name":"music"}</code></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="generate-a-native-executable-using-graalvm">8. Generate a Native Executable Using GraalVM</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The GDK supports compiling Java applications ahead-of-time into native executables using <a href="https://www.graalvm.org/">GraalVM Native Image</a>.
You can use the <em><a href="https://graalvm.github.io/native-build-tools/latest/gradle-plugin.html">Gradle plugin for GraalVM Native Image building</a></em>/<em><a href="https://graalvm.github.io/native-build-tools/latest/maven-plugin.html">Maven plugin for GraalVM Native Image building</a></em>.
Packaged as a native executable, it significantly reduces application startup time and memory footprint.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><strong>Prerequisites</strong>: Make sure you have installed a GraalVM JDK. The easiest way to get started is with <a href="https://sdkman.io/jdks#graal">SDKMAN!</a>. For other installation options, visit the <a href="https://www.graalvm.org/downloads/">Downloads section</a>.</p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>If you build a native executable locally, it will only run on your OS, and isn&#8217;t suitable for deployment to a compute instance.
To create a deployable native executable, use a different packaging command that builds the executable inside a container, which you can extract to deploy to the cloud.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>From a local console, generate a container image containing the native executable by running the following command:</p>
<div class="gradle-maven-tabs ui-tabs ui-corner-all ui-widget ui-widget-content">
    <ul role="tablist" class="ui-tabs-nav ui-corner-all ui-helper-reset ui-helper-clearfix ui-widget-header">
        <li class="tabs-gradle ui-tabs-tab ui-corner-top ui-state-default ui-tabs-active ui-state-active" role="tab" tabindex="0" aria-controls="gradle" aria-labelledby="ui-id-1" aria-selected="true" aria-expanded="true"><a name="gradle" href="#gradle" tabindex="-1" class="ui-tabs-anchor" id="ui-id-1">Gradle</a></li>
        <li class="tabs-maven ui-tabs-tab ui-corner-top ui-state-default" role="tab" tabindex="-1" aria-controls="maven" aria-labelledby="ui-id-2" aria-selected="false" aria-expanded="false"><a name="maven" href="#maven" tabindex="-1" class="ui-tabs-anchor" id="ui-id-2">Maven</a></li>
    </ul>
    <div id="gradle" aria-labelledby="ui-id-1" role="tabpanel" class="ui-tabs-panel ui-corner-bottom ui-widget-content" aria-hidden="false">
        <pre><code class="language-bash hljs" data-highlighted="yes">./gradlew :oci:dockerBuildNative</code><button>Copy</button></pre>
    </div>
    <div id="maven" aria-labelledby="ui-id-2" role="tabpanel" class="ui-tabs-panel ui-corner-bottom ui-widget-content" aria-hidden="true" style="display: none;">
        <pre><code class="language-bash hljs" data-highlighted="yes">./mvnw install -pl lib -am
./mvnw clean package -pl oci -Dpackaging=docker-native</code><button>Copy</button></pre>
    </div>
</div>
</li>
<li>
<p>Find the ID of the container image you built by running the following command:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">docker image ls</code></pre>
</div>
</div>
<div class="paragraph">
<p>The container images are listed chronologically with the most recent at the top, so your output will look like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">REPOSITORY   TAG      IMAGE ID       CREATED          SIZE
oci          latest   41c8a902b2e7   32 seconds ago   100MB</code></pre>
</div>
</div>
</li>
<li>
<p>Extract the native executable from the container image by running these commands, replacing <code>&lt;image_id&gt;</code> with the ID of the container image, for example, <code>41c8a902b2e7</code>:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">docker create --name container_temp &lt;image_id&gt;
docker cp container_temp:/app/application .
docker rm container_temp</code></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="deploy-from-a-native-executable">9. Deploy from a Native Executable</h2>
<div class="sectionbody">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>From a local console, copy the native executable from your computer to the compute instance using <code>scp</code>:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">scp -i /path/to/ssh-key-*.key application opc@[COMPUTE_INSTANCE_PUBLIC_IP]:~/</code></pre>
</div>
</div>
</li>
<li>
<p>Once copied, connect to the compute instance (if it has disconnected by now):</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">ssh -i /path/to/ssh-key-*.key opc@[COMPUTE_INSTANCE_PUBLIC_IP]</code></pre>
</div>
</div>
</li>
<li>
<p>Stop the application running from the JAR file if it&#8217;s still running.</p>
</li>
<li>
<p>Run the native executable:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">./application</code></pre>
</div>
</div>
</li>
<li>
<p>From the local console, repeat the tests from step <strong>7</strong> above.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="clean-up-cloud-resources">10. Clean up Cloud Resources</h2>
<div class="sectionbody">
<div class="paragraph">
<p>After you’ve completed this guide, you can clean up the resources you created.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><a href="https://docs.oracle.com/iaas/tools/oci-cli/latest/oci_cli_docs/cmdref/iam/policy/delete.html">Delete the policy</a> by running the following command:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">oci iam policy delete --policy-id $POLICY_ID</code></pre>
</div>
</div>
</li>
<li>
<p>To delete the dynamic group, find its OCID by running the <a href="https://docs.oracle.com/iaas/tools/oci-cli/latest/oci_cli_docs/cmdref/iam/dynamic-group/list.html"><code>list</code></a> command:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">oci iam dynamic-group list | jq -r '.data[] | select(.name=="gdk-guide-dg") | .id'</code></pre>
</div>
</div>
<div class="paragraph">
<p>and run the <a href="https://docs.oracle.com/iaas/tools/oci-cli/latest/oci_cli_docs/cmdref/iam/dynamic-group/delete.html"><code>delete</code></a> command, substituting the group OCID:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">oci iam dynamic-group delete --dynamic-group-id ocid1.dynamicgroup.oc1..aaaaaaaaipoabhhaqnj77urm...</code></pre>
</div>
</div>
</li>
<li>
<p>Delete the Vault. You cannot delete it directly; instead <a href="https://docs.oracle.com/iaas/tools/oci-cli/latest/oci_cli_docs/cmdref/kms/management/vault/schedule-deletion.html">request deletion</a> at a date at least seven days in the future.
Run this, replacing the date:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">oci kms management vault schedule-deletion \
    --vault-id $VAULT_ID \
    --time-of-deletion 2023-12-12</code></pre>
</div>
</div>
</li>
<li>
<p>Terminate the Compute instance (virtual machine):</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">oci compute instance terminate --instance-id &lt;instance_OCID&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Alternatively, you can do that from the Oracle cloud console: go to Compute, then Instances. Select the instance you want to permanently remove. From the More Actions drop-down, select Terminate to remove the instance.</p>
</div>
</li>
<li>
<p>Finally, delete the database <a href="https://docs.oracle.com/iaas/tools/oci-cli/latest/oci_cli_docs/cmdref/mysql/db-system/delete.html">using the CLI</a>. Run the following command:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">oci mysql db-system delete \
    --db-system-id ocid1.mysqldbsystem.oc1.iad.aaaaaaaa2pq3a37hftut...</code></pre>
</div>
</div>
</li>
</ol>
</div>
<h3 id="summary" class="discrete">Summary</h3>
<div class="paragraph">
<p>This guide demonstrated how to create a Java application that stores MySQL database connection details as <strong>secrets</strong> in an Oracle Cloud Infrastructure <strong>vault</strong>.
You also saw how to package this application into a native executable and deploy it to a Compute instance.</p>
</div>
<h3 id="related-labs" class="discrete">Related Labs</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://luna.oracle.com/lab/296b5fb9-32bc-4260-b83f-072d4dd2d3c4">Oracle Cloud Infrastructure Autonomous DB, Vault, Micronaut, Graal Development Kit</a></p>
</li>
<li>
<p><a href="https://luna.oracle.com/lab/c28c56d0-3bfa-4905-9fcd-6ba6e8a3ea42">Oracle Cloud Infrastructure MySQL, Vault, Micronaut, Graal Development Kit</a></p>
</li>
</ul>
</div>
<h3 id="related-documentation" class="discrete">Related Documentation</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://micronaut-projects.github.io/micronaut-oracle-cloud/latest/guide/">Micronaut Oracle Cloud</a></p>
</li>
<li>
<p><a href="https://docs.oracle.com/iaas/Content/KeyManagement/home.htm">Oracle Cloud Infrastructure Vault</a></p>
</li>
</ul>
</div>
</div>
</div></div>
                        <div role="button" class="menu-btn menu-btn--sidebar js-show-sidebar" title="sweet hamburger">
                            <div class="hamburger">
                                <div class="inner"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </article>



        </div>

    </main>


    <footer class="footer footer__mobile">

        <div class="container-fluid container-fluid--custom-sm">
            <div class="row">
                <div class="col-12 col-sm-12 col-md-12 col-lg-12">
                    <div class="row footer-content">
                        <div class="col-md-3 col-sm-4">
                            <h6 class="title-footer" onclick="fadeInAndOut(this)">Learn</h6>
                            <div class="grow">
                                <ul class="footer-list">
                                    <li class="footer-list__item"><a href="/gdk/get-started/">Get Started</a></li>
                                    <li class="footer-list__item"><a href="/gdk/guides/">Guides</a></li>
                                    <li class="footer-list__item"><a href="/gdk/hands-on-labs/">Labs</a></li>
                                    <li class="footer-list__github">
                                        <img class="footer__icon" src="https://graal.cloud/gdk/resources/img/footer/logo-github.svg" alt="Github icon">
                                        <a href="https://github.com/oracle/graal-dev-kit" target="blank">Github</a>
                                    </li>
                                    <li class="footer-list__github">
                                        <img class="footer__icon" src="https://graal.cloud/gdk/resources/img/footer/slack-icon.svg" alt="Github icon">
                                        <a href="https://bit.ly/odevrel_slack" target="blank">#graal-dev-kit-for-micronaut</a>
                                    </li>
                                </ul>
                            </div>
                        </div>
                        <div class="col-md-3 col-sm-4">
                            <h6 class="title-footer" onclick="fadeInAndOut(this)">About</h6>
                            <div class="grow">
                                <ul class="footer-list">
                                    <li class="footer-list__item"><a href="/gdk/about/#gdk-support" target="blank">Commercial Support</a></li>
                                    <li class="footer-list__item"><a href="https://www.graalvm.org/" target="blank">GraalVM Native Image</a></li>
                                    <li class="footer-list__item"><a href="https://micronaut.io/" target="_blank">Micronaut<sup>®</sup> Framework</a></li>
                                    <li class="footer-list__item"><a href="https://www.oracle.com/cloud/multicloud/what-is-multicloud/" target="_blank">Multicloud</a></li>
                                    <li class="footer-list__item"><a href="https://www.oracle.com/cloud/" target="blank">Oracle Cloud Infrastructure</a></li>
                                    <li class="footer-list__item"><a href="https://marketplace.visualstudio.com/items?itemName=oracle-labs-graalvm.graal-cloud-native-pack" target="blank">VS Code Tools</a></li>
                                </ul>
                            </div>
                        </div>
                        <div class="col-md-6 col-sm-12 aligning_1024">
                            <div class="card--footer card--hovered box">
                                <div>
                                    <div class="rubber-footer footer__oci-section">
                                        <p class="title-footer quickstart">Build, test, and deploy applications on Oracle Cloud Infrastructure for free</p>
                                        <a href="https://www.oracle.com/cloud/free/" target="_blank" class="btn btn-primary">Try Oracle Cloud Infrastructure Free Tier</a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="col-12 col-sm-12 col-md-12 col-lg-12">
                        <div class="row">
                            <div class="col-sm-12">
                                <p class="copyright">
                                    Copyright © 2023, 2025, Oracle and/or its affiliates.
                                    All rights reserved.
                                    Oracle and Java are registered trademarks of Oracle and/or its affiliates.<br>
                                    Micronaut<sup>®</sup> is a registered trademark of Object Computing, Inc.
                                    Use is for referential purposes and does not imply any endorsement or affiliation with any third-party product.
                                    Unauthorized use is strictly prohibited. Other names may be trademarks of their respective owners.
                                </p>
                                <div id="teconsent"></div>
                            </div>
                        </div>

                    </div>
                </div>

            </div>
        </div>
    </footer>

    <script>
        function fadeInAndOut(thz) {
            var elmt = thz.nextElementSibling;//Get the element that is below the button that
            //was just clicked
            if (elmt.clientHeight) {
                elmt.style.height = 0;
            } else {
                var wrapper = elmt.querySelector('ul');
                elmt.style.height = wrapper.clientHeight + "px";
            }
            /*
                elmt.classList.toggle("acordianPanelHidden");//Toggle the class which changes
                //attributes which triggers the transition CSS
                */
        }

        // Check TRUSTe Consent for Functional or Implied Approval
        // The if test verifies if the user has given the consent
        if ( (oracle.truste.api.getGdprConsentDecision().consentDecision) &&
            (oracle.truste.api.getGdprConsentDecision().consentDecision.indexOf(0) != -1 ||
                oracle.truste.api.getGdprConsentDecision().consentDecision.indexOf(2) != -1) ) {

            //The following is a sample of a Maxymiser Tag being written to the DOM
            //If the user did not give consent, then the tag is not included and not invoked in the Browser
            document.write('<script type="text/javascript" src="//service.maxymiser.net/cdn/oracle/js/mmcore.js"><\/script>');
        }

        // Check TRUSTe Consent for Advertising or Implied Approval
        // The if test verifies if the user has given the consent
        if ( (oracle.truste.api.getGdprConsentDecision().consentDecision) &&
            (oracle.truste.api.getGdprConsentDecision().consentDecision.indexOf(0) != -1 ||
                oracle.truste.api.getGdprConsentDecision().consentDecision.indexOf(3) != -1) ) {

            //The following is a sample of a BlueKai Core Tag being written to the DOM
            //If the user did not give consent, then the tag is not included and not invoked in the Browser
            document.write('<script type="text/javascript">' +
                'window.bk_async = function() { ' +
                'BKTAG.doTag(62581, 1); }; ' +
                '(function() { ' +
                'var scripts = document.getElementsByTagName(\'script\')[0]; ' +
                'var s = document.createElement(\'script\'); ' +
                's.async = true; ' +
                's.src = "https://tags.bkrtx.com/js/bk-coretag.js"; ' +
                'scripts.parentNode.insertBefore(s, scripts); ' +
                '}()); ' +
                '<\/script>');
        }
    </script><script type="text/javascript" src="//service.maxymiser.net/cdn/oracle/js/mmcore.js"></script><script type="text/javascript">window.bk_async = function() { BKTAG.doTag(62581, 1); }; (function() { var scripts = document.getElementsByTagName('script')[0]; var s = document.createElement('script'); s.async = true; s.src = "https://tags.bkrtx.com/js/bk-coretag.js"; scripts.parentNode.insertBefore(s, scripts); }()); </script>

</div>
<div class="overlay"></div>

<!-- Start SiteCatalyst code -->
<script language="JavaScript" src="https://www.oracle.com/us/assets/metrics/ora_otn.js"></script><script type="text/javascript" src="https://www.oracleimg.com/us/assets/metrics/ora_code_otn.js"></script><script type="text/javascript" src="https://www.oracleimg.com/us/assets/metrics/ora_code.js"></script>
<!-- End SiteCatalyst code -->

<script src="https://graal.cloud/gdk/resources/lib/slick-slider/slick.min.js"></script>
<script src='https://graal.cloud/gdk/resources/js/main.js'></script>
<script src="https://graal.cloud/gdk/resources/js/ui.js"></script>
<script src="https://graal.cloud/gdk/resources/js/filters.js"></script>
<script src="https://graal.cloud/gdk/resources/js/sidebar.js"></script>
<script src="https://graal.cloud/gdk/resources/js/labs.js"></script>
<!--<script>-->
<!--    hljs.initHighlightingOnLoad();-->
<!--</script>-->


<iframe name="trustarc_notice" id="trustarcNoticeFrame" title="Trustarc Cross-Domain Consent Frame" src="https://consent.trustarc.com/get?name=crossdomain.html&amp;domain=oracle.com" style="display: none;"></iframe></body></html>